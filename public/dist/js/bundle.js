/*! For license information please see bundle.js.LICENSE.txt */
(function(){var __webpack_modules__={251:function(t,e){e.read=function(t,e,i,s,n){var a,r,o=8*n-s-1,h=(1<<o)-1,l=h>>1,c=-7,_=i?n-1:0,d=i?-1:1,u=t[e+_];for(_+=d,a=u&(1<<-c)-1,u>>=-c,c+=o;c>0;a=256*a+t[e+_],_+=d,c-=8);for(r=a&(1<<-c)-1,a>>=-c,c+=s;c>0;r=256*r+t[e+_],_+=d,c-=8);if(0===a)a=1-l;else{if(a===h)return r?NaN:1/0*(u?-1:1);r+=Math.pow(2,s),a-=l}return(u?-1:1)*r*Math.pow(2,a-s)},e.write=function(t,e,i,s,n,a){var r,o,h,l=8*a-n-1,c=(1<<l)-1,_=c>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,u=s?0:a-1,f=s?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,r=c):(r=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-r))<1&&(r--,h*=2),(e+=r+_>=1?d/h:d*Math.pow(2,1-_))*h>=2&&(r++,h/=2),r+_>=c?(o=0,r=c):r+_>=1?(o=(e*h-1)*Math.pow(2,n),r+=_):(o=e*Math.pow(2,_-1)*Math.pow(2,n),r=0));n>=8;t[i+u]=255&o,u+=f,o/=256,n-=8);for(r=r<<n|o,l+=n;l>0;t[i+u]=255&r,u+=f,r/=256,l-=8);t[i+u-f]|=128*p}},761:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _constants_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2454);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),selectItemEvent=28.75;function onActionBar_click(t){t.stopPropagation();let e=t.target;e.classList.contains("action-bar-item")||(e=e.parentElement);const i=parseInt(e.getAttribute("index"));if(e.querySelector(".action-bar-item-icon").classList.contains("action-weapon"))return _constants_js__WEBPACK_IMPORTED_MODULE_0__.sZ.send(selectItemEvent*fourInt,i,!0);_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.buildIndex!==i&&_constants_js__WEBPACK_IMPORTED_MODULE_0__.sZ.send(selectItemEvent*fourInt,i)}__webpack_exports__.A=onActionBar_click},816:function(t,e,i){e.u=function t(e,i){if(!(this instanceof t))return new t(e,i);this.buffer=s.from(e),this.type=i};var s=i(8204)},897:function(t,e,i){var s=i(816).u,n=i(8236),a=i(3398),r=i(8704);function o(){var t=this.options;return this.encode=function(t){var e=a.getWriteType(t);return function(t,i){var s=e[typeof i];if(!s)throw new Error('Unsupported type "'+typeof i+'": '+i);s(t,i)}}(t),t&&t.preset&&n.setExtPackers(this),this}r.install({addExtPacker:function(t,e,i){i=r.filter(i);var n=e.name;if(n&&"Object"!==n){(this.extPackers||(this.extPackers={}))[n]=a}else{(this.extEncoderList||(this.extEncoderList=[])).unshift([e,a])}function a(e){return i&&(e=i(e)),new s(e,t)}},getExtPacker:function(t){var e=this.extPackers||(this.extPackers={}),i=t.constructor,s=i&&i.name&&e[i.name];if(s)return s;for(var n=this.extEncoderList||(this.extEncoderList=[]),a=n.length,r=0;r<a;r++){var o=n[r];if(i===o[0])return o[1]}},init:o}),e.preset=o.call(r.preset)},924:function(t){function e(t){return t&&t.isBuffer&&t}t.exports=e("undefined"!=typeof Buffer&&Buffer)||e(this.Buffer)||e("undefined"!=typeof window&&window.Buffer)||this.Buffer},1189:function(t,e){"use strict";e.A=function(){const t="INPUT"===document.activeElement.tagName,e="text"===document.activeElement.type;return t&&e}},1325:function(t,e,i){i(3294),i(897),i(8704).createCodec},1490:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5710),_constants_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2454),_game_configs_hats_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9879),_game_configs_modules_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8372),_utils_$Element_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9590);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),equipHatEvent=32.75;class StoreMenu{constructor(){this.$navStoreHats=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_4__.A("#store_nav_hats"),this.$navStoreModules=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_4__.A("#store_nav_modules"),this.$hatsMenu=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_4__.A("#store_menu_hats"),this.$modulesMenu=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_4__.A("#store_menu_modules"),this.activeModules=[],this.init()}hasModule(t){return this.activeModules.includes(t)??!1}getHatItemLayout(t,e,i,s,n){return`\n        <li class="store-hat-item ui-element${"Buy"===n?" is-buy":""}" itemid="${t}">\n            <div class="store-item-info">\n                <img class="store-item-image" src="${e}"></img>\n                <span class="store-info-text store-hat-name">${i}</span>\n            </div>\n\n            <div class="store-item-actions">\n                <div class="store-btn store-action-btn game-button ui-element${"Buy"!==n?" is-purchased":""}">\n                    <span class="store-btn-text" price="${s}" state="${n}"></span>\n                </div>\n            </div>\n        </li>\n        `}getModuleItemLayout(t,e,i,s,n){return`\n        <li class="store-module-item ui-element${"Buy"===n?" is-buy":""}" itemid="${t}">\n            <div class="store-item-info">\n                <img class="store-item-image" src="${e}"></img>\n                <span class="store-info-text store-module-name">${i}</span>\n            </div>\n\n            <div class="store-item-actions">\n                <div class="store-btn store-action-btn game-button ui-element${"Buy"!==n?" is-purchased":""}">\n                    <span class="store-btn-text" price="${s}" state="${n}"></span>\n                </div>\n            </div>\n        </li>\n        `}addHatsItems(){const t=Object.values(_game_configs_hats_js__WEBPACK_IMPORTED_MODULE_2__.A).sort(((t,e)=>t.price-e.price));for(const e of t){const t=this.getHatItemLayout(e.id,e.iconSrc,e.name,e.price,e.price?"Buy":"Equip");this.$hatsMenu.insert(t);const i=document.querySelector(`.store-hat-item[itemid="${e.id}"]`);this.initItemEvents(i,_game_configs_hats_js__WEBPACK_IMPORTED_MODULE_2__.A)}}addModulesItems(){const t=Object.values(_game_configs_modules_js__WEBPACK_IMPORTED_MODULE_3__.A).sort(((t,e)=>t.price-e.price));for(const e of t){const t=this.getModuleItemLayout(e.id,e.iconSrc,e.name,e.price,e.price?"Buy":"Equip");this.$modulesMenu.insert(t);const i=document.querySelector(`.store-module-item[itemid="${e.id}"]`);this.initItemEvents(i,_game_configs_modules_js__WEBPACK_IMPORTED_MODULE_3__.A)}}unequipAllHats(){const t=[...document.querySelectorAll(".store-hat-item")];for(const e of t){const t=e.querySelector(".store-action-btn").querySelector(".store-btn-text");"Buy"!==t.getAttribute("state")&&t.setAttribute("state","Equip")}}initItemEvents(t,e){t.addEventListener("click",(i=>{if(!i?.isTrusted)return;i.stopPropagation();const s=parseInt(t.getAttribute("itemid"));if(!s)return;const n=e[s];if(!i.target.classList.contains("store-action-btn")&&!i.target.classList.contains("store-btn-text"))return;const a=t.querySelector(".store-action-btn"),r=a.querySelector(".store-btn-text"),o=r.getAttribute("state");if(t.classList.contains("is-buy"))return _constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.gold<n.price?void(a.classList.contains("red-anim")||(a.classList.add("red-anim"),setTimeout((()=>{a.classList.remove("red-anim")}),500))):(t.classList.remove("is-buy"),a.classList.add("is-purchased"),r.setAttribute("state",n.isModule?"Active":"Equip"),n.isModule&&(this.activeModules.push(n.effect),this.hasModule("zoom_out")?(_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ji.viewport.zoom=_config_js__WEBPACK_IMPORTED_MODULE_0__.A.viewport.zoom+.2,_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ji.resize()):_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ji.viewport.zoom=_config_js__WEBPACK_IMPORTED_MODULE_0__.A.viewport.zoom),_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(equipHatEvent*fourInt,1,s,Number(n.isModule)));n.isModule||(n.isHat&&this.unequipAllHats(),_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(equipHatEvent*fourInt,0,s,Number(n.isModule)),r.setAttribute("state","Equip"===o?"Unequip":"Equip"))})),t.addEventListener("mouseover",(i=>{if(!i?.isTrusted)return;i.stopPropagation();const s=parseInt(t.getAttribute("itemid"));if(!s)return;const n=e[s];(i.target.classList.contains("store-action-btn")||i.target.classList.contains("store-btn-text"))&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.lP.show(n)})),t.addEventListener("mouseout",(t=>{_constants_js__WEBPACK_IMPORTED_MODULE_1__.lP.hide()}))}init(){this.$navStoreHats.on("click",(t=>{t?.isTrusted&&(this.$navStoreModules.classes.remove("active-game-btn"),this.$navStoreHats.classes.add("active-game-btn"),this.$modulesMenu.hide(),this.$hatsMenu.show())})),this.$navStoreModules.on("click",(t=>{t?.isTrusted&&(this.$navStoreHats.classes.remove("active-game-btn"),this.$navStoreModules.classes.add("active-game-btn"),this.$hatsMenu.hide(),this.$modulesMenu.show())})),this.addHatsItems(),this.addModulesItems()}}__webpack_exports__.A=StoreMenu},1611:function(t){!function(e){t.exports=e;var i="listeners",s={on:function(t,e){return r(this,t).push(e),this},once:function(t,e){var i=this;return s.originalListener=e,r(i,t).push(s),i;function s(){a.call(i,t,s),e.apply(this,arguments)}},off:a,emit:function(t,e){var i=this,s=r(i,t,!0);if(!s)return!1;var n=arguments.length;if(1===n)s.forEach((function(t){t.call(i)}));else if(2===n)s.forEach((function(t){t.call(i,e)}));else{var a=Array.prototype.slice.call(arguments,1);s.forEach((function(t){t.apply(i,a)}))}return!!s.length}};function n(t){for(var e in s)t[e]=s[e];return t}function a(t,e){var s,n=this;if(arguments.length){if(e){if(s=r(n,t,!0)){if(!(s=s.filter((function(t){return t!==e&&t.originalListener!==e}))).length)return a.call(n,t);n[i][t]=s}}else if((s=n[i])&&(delete s[t],!Object.keys(s).length))return a.call(n)}else delete n[i];return n}function r(t,e,s){if(!s||t[i]){var n=t[i]||(t[i]={});return n[e]||(n[e]=[])}}n(e.prototype),e.mixin=n}((function t(){if(!(this instanceof t))return new t}))},1635:function(t,e,i){"use strict";i.d(e,{A:function(){return E}});var s=i(5710),n=i(2454),a=i(9879),r=i(3002),o=i(8360),h=i(9590),l=i(3919);var c=function(t,e,i){return t+(e-t)*(i=(i=i<0?0:i)>1?1:i)},_=i(6021);var d=class{constructor({scaleRatio:t,reductionWhenRunning:e,entity:i,speeds:s}){this.scaleRatio=t,this.reductionWhenRunning=e,this.entity=i,this.speeds=s,this.cycleState=1,this._cycleTick=0}get maxCycleSpeed(){return this.reductionWhenRunning&&this.entity.speed>=5?this.speeds.max-1:this.speeds.max}get minCycleSpeed(){return this.reductionWhenRunning&&this.entity.speed>=5?this.speeds.min-21:this.speeds.min}get cycleTick(){return Math.max(Math.min(this._cycleTick,this.maxCycleSpeed),this.minCycleSpeed)}set cycleTick(t){this._cycleTick=t}get breathScale(){return this.cycleTick/this.scaleRatio}update(t){1===this.cycleState?this.cycleTick>=this.maxCycleSpeed&&(this.cycleState=-1):this.cycleTick<=this.minCycleSpeed&&(this.cycleState=1),this.cycleTick+=Math.abs(t)*this.cycleState}},u=i(4457),f=i(2705),p=i(6355);var m=function(t){const e=n.Uq.get("icons");let i=e[t];return i||(e[t]={},i=e[t],i.image=new Image,i.image.onload=()=>{i.isLoaded=!0},i.image.src=`./assets/icons/${t}_icon.png`),i},y=i(5160);class g extends l.A{constructor(t){super(0,0,s.A.player.scale),this.setTo(t[1],t[2]),this.id=t[0],this.nickname=t[3],this.skinIndex=t[4]||0,this.t1=null,this.t2=null,this.x1=this.x,this.y1=this.y,this.x2=this.x1,this.y2=this.y1,this.dir=0,this.dir1=null,this.dir2=null,this.dirPlus=0,this.weaponIndex=0,this.buildIndex=-1,this.hatIndex=0,this.speed=0,this.clan=null,this.isClanLeader=!1,this.dt=0,this.isAttack=!1,this.animAttackTime=0,this.animAttackIndex=0,this.animAttackRatio=0,this.animSpeed=0,this.targetAngle=-s.A.hitAngle,this.attackState=!1,this.autoAttackState=!1,this.health=t[5],this.maxHealth=s.A.player.maxHealth,this.gold=0,this.food=0,this.wood=0,this.stone=0,this.weapons=[],this.items=[],this.messages=[],this.lockDir=!1,this.itemsCount={},this.skinRotate=0,this.hatImage=null,this.hatSpriteIndex=0,this.hatSpriteReverse=!1,this.hatSpriteTime=null,this.breathAnimation=new d({scaleRatio:300,reductionWhenRunning:!0,entity:this,speeds:{min:1,max:500}}),this.inGame=!0,this.effectsIDs=0,this.effectsManager=new u.A(this)}get weapon(){return o.A[this.weaponIndex]}get hat(){return a.A[this.hatIndex]}get isAlly(){return n.kf.isMemeber(this.id)}kill(){this.isAlive=!1,this.inGame=!1,this.weapons=[],this.items=[],this.isNeedSelectUpgrade=!1,this.selectUpgrades=[],n.pH.html=""}updateLevel(t,e,i){this.level=t,this.xp=e,this.maxXP=i}updateWeapons(t){this.weapons=t}updateItems(t){this.items=t}updateItemsCount(t){this.itemsCount=t}updateUpgradesItems(t){n.pH.html="";for(let e=0;e<t.length;e+=2){const i=t.slice(e,e+2),s=i[1]?o.A[i[0]]:r.A[i[0]];if(!s)continue;if(i[1]){const t=(0,y.A)(s);n.pH.insert(`\n                <div class="action-bar-item" windex="${s.id}">\n                    <div class="action-bar-item-holder"></div>\n                </div>\n                `);const e=new h.A(`.action-bar-item[windex="${s.id}"] > .action-bar-item-holder`);t.image.classList.add("action-bar-item-icon","action-weapon"),t.image.setAttribute("draggable","false"),t.image.style.transform=`rotate(225deg) translateY(${s.cssTranslate}px) scale(${s.cssScale})`,t.isLoaded?e.append(t.image):t.image.addEventListener("load",(()=>{e.append(t.image)}));continue}const a=(0,f.A)(s,!0,/berry/.test(s.name)?3:null);n.pH.insert(`\n            <div class="action-bar-item" index="${s.id}">\n                <div class="action-bar-item-holder">\n                    <img class="action-bar-item-icon action-item" src="${a.toDataURL()}" bindex="${s.id}" draggable="false">\n                </div>\n            </div>\n            `)}}updateActionItems(){n.er.html="";let t=1;for(let e=0;e<this.weapons.length;e++){const i=this.weapons[e],s=o.A[i];if(!s)continue;const a=(0,y.A)(s);n.er.insert(`\n            <div class="action-bar-item" index="${i}" hotkey="${t}">\n                <div class="action-bar-item-holder"></div>\n            </div>\n            `);const r=new h.A(`.action-bar-item[index="${i}"] > .action-bar-item-holder`);a.image.classList.add("action-bar-item-icon","action-weapon"),a.image.setAttribute("draggable","false"),a.image.style.transform=`rotate(225deg) translateY(${s.cssTranslate}px) scale(${s.cssScale})`,a.isLoaded?r.append(a.image):a.image.addEventListener("load",(()=>{r.append(a.image)})),t+=1}for(let e=0;e<this.items.length;e++){const i=this.items[e],s=r.A[i];if(!s)continue;const a=(0,f.A)(s,!0,/berry/.test(s.name)?3:null);n.er.insert(`\n            <div class="action-bar-item" index="${i}" hotkey="${t}">\n                <div class="action-bar-item-holder">\n                    <img class="action-bar-item-icon action-item" src="${a.toDataURL()}" draggable="false">\n                </div>\n            </div>\n            `),t+=1}}setData(t){this.dt=0,this.x1=this.x,this.y1=this.y,this.x2=t[1],this.y2=t[2],this.speed=Math.hypot(this.y2-this.y1,this.x2-this.x1),this.dir1=null!==this.dir2?this.dir2:t[3],this.dir2=t[3],this.t1=null!==this.t2?this.t2:Date.now(),this.t2=Date.now(),this.isAlive=!0,this.weaponIndex=t[4],this.buildIndex=t[5],this.hatIndex=t[6],this.clan=t[7],this.isClanLeader=t[8],this.effectsIDs=t[9]?.toString()}receiveChat(t){this.messages=this.messages.slice(0,s.A.player.chat.maxMessages),this.messages=[{value:t,createdTime:Date.now()}].concat(this.messages)}changeHealth(t){this.health=t}startGatherAnimation(t){!this.isAttack&&this.weapon&&(this.isAttack=!0,this.dirPlus=0,this.animAttackTime=0,this.animAttackRatio=0,this.animAttackIndex=0,this.animAttackTime=this.animSpeed=this.weapon.speed,this.targetAngle=t?-s.A.hitAngle:-Math.PI)}stopGatherAnimation(){this.isAttack=!1,this.dirPlus=0,this.animAttackTime=0,this.animAttackRatio=0,this.animAttackIndex=0,this.animSpeed=0}updateGatherAnimation(){this.isAttack&&this.animAttackTime>0&&(this.animAttackTime-=n.Uk.delta,this.animAttackTime<=0?this.stopGatherAnimation():0==this.animAttackIndex?(this.animAttackRatio+=n.Uk.delta/(this.animSpeed*s.A.hitReturnRatio),this.dirPlus=c(0,this.targetAngle,Math.min(1,this.animAttackRatio)),this.animAttackRatio>=1&&(this.animAttackRatio=1,this.animAttackIndex=1)):(this.animAttackRatio-=n.Uk.delta/(this.animSpeed*(1-s.A.hitReturnRatio)),this.dirPlus=c(0,this.targetAngle,Math.max(0,this.animAttackRatio))))}renderClan(){if(!this.isAlive||!this.inGame||!this.clan)return;const t=s.A.player.clan,e=`[${this.clan}]`;n._O.save(),n._O.font=`${t.size}px ${s.A.textFont}`;const i=n._O.measureText(e),a=i.actualBoundingBoxAscent+(i.actualBoundingBoxDescen||0);if(n._O.fillStyle=t.color,n._O.strokeStyle=t.outlineColor,n._O.textBaseline="middle",n._O.textAlign="center",n._O.lineWidth=t.outlineWidth,n._O.lineJoin="round",n._O.translate(this.x-n.UI.xOffset+t.xOffset,this.y-n.UI.yOffset-this.scale+t.yOffset),n._O.strokeText(e,0,0),n._O.fillText(e,0,0),this.isClanLeader){const e=m("clan_leader");e.isLoaded&&n._O.drawImage(e.image,-(t.leaderIconScale+i.width/2)+t.leaderIconXOffset,-(t.leaderIconScale-a/2)+t.leaderIconYOffset,t.leaderIconScale,t.leaderIconScale)}n._O.restore()}renderNickname(){if(!this.isAlive||!this.inGame)return;const t=s.A.player.nickname;this.renderClan(),n._O.save(),n._O.font=`${t.size}px ${s.A.textFont}`,n._O.fillStyle=t.color,n._O.strokeStyle=t.outlineColor,n._O.textBaseline="middle",n._O.textAlign="center",n._O.lineWidth=t.outlineWidth,n._O.lineJoin="round",n._O.translate(this.x-n.UI.xOffset,this.y-n.UI.yOffset-this.scale),n._O.strokeText(this.nickname,t.xOffset,t.yOffset),n._O.fillText(this.nickname,t.xOffset,t.yOffset),n._O.restore()}renderHealthbar(){if(!this.isAlive||!this.inGame)return;const t=s.A.player.healthbar;n._O.save(),n._O.translate(this.x-n.UI.xOffset,this.y-n.UI.yOffset+this.scale),n._O.fillStyle=t.outlineColor,n._O.roundRect(-t.width-t.padding+t.xOffset,t.yOffset,2*t.width+2*t.padding,t.height,t.radius),n._O.fill();const e=n._O.createLinearGradient(-t.width+t.xOffset,t.yOffset+t.padding+(t.height-2*t.padding)/2,0,t.height-2*t.padding);e.addColorStop(0,this.isAlly?t.allyColor[0]:t.enemyColor[0]),e.addColorStop(1,this.isAlly?t.allyColor[1]:t.enemyColor[1]),n._O.fillStyle=e,n._O.roundRect(-t.width+t.xOffset,t.yOffset+t.padding,2*t.width*(this.health/this.maxHealth),t.height-2*t.padding,t.radius-1),n._O.fill(),n._O.restore()}renderWeapon(){if(!this.weapon||!this.isAlive||!this.inGame)return;const t=(0,y.A)(this.weapon),e=this.id!==n.wB.player.id||this.lockDir?this.dir:this.mouseDir,i=this.scale+this.breathAnimation.breathScale;t.isLoaded&&(n._O.save(),n._O.translate(this.x-n.UI.xOffset,this.y-n.UI.yOffset),n._O.rotate(e+this.dirPlus-(this.weapon.plusRotate||0)),n._O.drawImage(t.image,i/2-this.weapon.xOffset-this.weapon.length/2,i/2-this.weapon.yOffset-this.weapon.width/2,this.weapon.length,this.weapon.width),n._O.restore())}renderChat(){if(!this.isAlive||!this.inGame)return;const t=s.A.player.chat;for(let e=1;e<=this.messages.length;e++){const i=this.messages[e-1],a=Date.now()-i.createdTime;if(a>=s.A.chatRemoveTime){this.messages.pop();continue}n._O.save(),n._O.font=`${t.textSize}px ${s.A.textFont}`;const r=n._O.measureText(i.value);let o=1;a>=s.A.chatRemoveTime-t.alphaTime?o=1-(a-(s.A.chatRemoveTime-t.alphaTime))/t.alphaTime:a<=t.alphaTime&&(o=a/t.alphaTime),n._O.globalAlpha=o,n._O.textBaseline="middle",n._O.textAlign="center",n._O.translate(this.x-n.UI.xOffset,this.y-n.UI.yOffset-this.scale*e-t.margin*e);const h=r.width+t.width,l=t.height,c=t.yOffset*(this.clan?1.5:1);n._O.fillStyle=t.bgColor,n._O.roundRect(-h/2+t.xOffset,-l/2+c,h,l,6),n._O.fill(),n._O.fillStyle=t.color,n._O.fillText(i.value,t.xOffset,c),n._O.restore()}}render(){if(!this.isAlive||!this.inGame)return;const t=Math.PI/4,e=this.buildIndex<0&&this.weapon.handXOffsets||[0,0],i=this.buildIndex<0&&this.weapon.handYOffsets||[0,0],a=this.id!==n.wB.player.id||this.lockDir?this.dir:this.mouseDir,o=s.A.player,h=this.scale+this.breathAnimation.breathScale,l=o.handScale+this.breathAnimation.breathScale;if(this.buildIndex<0&&!this.weapon.aboveHand&&this.renderWeapon(),n._O.save(),n._O.strokeStyle=o.outlineColor,n._O.fillStyle=o.colors[this.skinIndex],n._O.lineWidth=o.outlineWidth,n._O.lineJoin="miter",n._O.translate(this.x-n.UI.xOffset,this.y-n.UI.yOffset),n._O.rotate(a+this.dirPlus),(0,_.A)(h*Math.cos(t)+e[0],h*Math.sin(t)+i[0],l,n._O),n._O.fill(),n._O.stroke(),(0,_.A)(h*Math.cos(-t)+e[1],h*Math.sin(-t)+i[1],l,n._O),n._O.fill(),n._O.stroke(),this.buildIndex>=0){const t=r.A[this.buildIndex];if(t){const e=(0,f.A)(t,/windmill/.test(t.name));n._O.drawImage(e,h-t.holdOffset,-e.width/2)}}if((0,_.A)(0,0,h,n._O),n._O.fill(),n._O.stroke(),this.hatIndex>0){let t=this.hat.src;Array.isArray(t)&&(this.hat.reverseSpriteAnim?this.hatSpriteIndex>=t.length-1?this.hatSpriteReverse=!0:this.hatSpriteIndex<1&&(this.hatSpriteReverse=!1):(this.hatSpriteReverse=!1,this.hatSpriteIndex>=t.length&&(this.hatSpriteIndex=0)),t=t[this.hatSpriteIndex],(!this.hatSpriteTime||Date.now()-this.hatSpriteTime>=this.hat.spriteFrameSpeed)&&(this.hatSpriteIndex+=this.hatSpriteReverse?-1:1,this.hatSpriteTime=Date.now()));const e=this.hatImage=(0,p.A)(t);if(e.isLoaded){const t=this.hat.scale+this.breathAnimation.breathScale;n._O.rotate(Math.PI/2),n._O.rotate(this.skinRotate),n._O.drawImage(e.image,-t/2,-t/2,t,t)}this.hat.skinRotate&&(this.skinRotate+=this.hat.skinRotate*n.Uk.delta)}n._O.restore(),this.effectsManager.update()}update(){if(this.isAlive&&this.inGame)if(this.isAttack&&this.updateGatherAnimation(),this.breathAnimation.update(n.Uk.delta),this.render(),this.effectsIDs){const t=this.effectsIDs.match(/../g);if(!t)return this.effectsManager.effects.clear();this.effectsManager.effects.forEach(((e,i)=>{t.includes(i.toString())||e.destroy()}));for(let e=0;e<t.length;e++){const i=parseInt(t[e]);this.effectsManager.add(i)}}else this.effectsManager.effects.clear()}}var E=g},1685:function(t,e,i){var s=i(251),n=i(8305),a=n.Uint64BE,r=n.Int64BE,o=i(4040).h,h=i(8204),l=h.global,c=h.hasBuffer&&"TYPED_ARRAY_SUPPORT"in l&&!l.TYPED_ARRAY_SUPPORT,_=h.hasBuffer&&l.prototype||{};function d(){var t=o.slice();return t[196]=u(196),t[197]=f(197),t[198]=p(198),t[199]=u(199),t[200]=f(200),t[201]=p(201),t[202]=m(202,4,_.writeFloatBE||E,!0),t[203]=m(203,8,_.writeDoubleBE||w,!0),t[204]=u(204),t[205]=f(205),t[206]=p(206),t[207]=m(207,8,y),t[208]=u(208),t[209]=f(209),t[210]=p(210),t[211]=m(211,8,g),t[217]=u(217),t[218]=f(218),t[219]=p(219),t[220]=f(220),t[221]=p(221),t[222]=f(222),t[223]=p(223),t}function u(t){return function(e,i){var s=e.reserve(2),n=e.buffer;n[s++]=t,n[s]=i}}function f(t){return function(e,i){var s=e.reserve(3),n=e.buffer;n[s++]=t,n[s++]=i>>>8,n[s]=i}}function p(t){return function(e,i){var s=e.reserve(5),n=e.buffer;n[s++]=t,n[s++]=i>>>24,n[s++]=i>>>16,n[s++]=i>>>8,n[s]=i}}function m(t,e,i,s){return function(n,a){var r=n.reserve(e+1);n.buffer[r++]=t,i.call(n.buffer,a,r,s)}}function y(t,e){new a(this,e,t)}function g(t,e){new r(this,e,t)}function E(t,e){s.write(this,t,e,!1,23,4)}function w(t,e){s.write(this,t,e,!1,52,8)}e.getWriteToken=function(t){return t&&t.uint8array?((e=d())[202]=m(202,4,E),e[203]=m(203,8,w),e):c||h.hasBuffer&&t&&t.safe?function(){var t=o.slice();return t[196]=m(196,1,l.prototype.writeUInt8),t[197]=m(197,2,l.prototype.writeUInt16BE),t[198]=m(198,4,l.prototype.writeUInt32BE),t[199]=m(199,1,l.prototype.writeUInt8),t[200]=m(200,2,l.prototype.writeUInt16BE),t[201]=m(201,4,l.prototype.writeUInt32BE),t[202]=m(202,4,l.prototype.writeFloatBE),t[203]=m(203,8,l.prototype.writeDoubleBE),t[204]=m(204,1,l.prototype.writeUInt8),t[205]=m(205,2,l.prototype.writeUInt16BE),t[206]=m(206,4,l.prototype.writeUInt32BE),t[207]=m(207,8,y),t[208]=m(208,1,l.prototype.writeInt8),t[209]=m(209,2,l.prototype.writeInt16BE),t[210]=m(210,4,l.prototype.writeInt32BE),t[211]=m(211,8,g),t[217]=m(217,1,l.prototype.writeUInt8),t[218]=m(218,2,l.prototype.writeUInt16BE),t[219]=m(219,4,l.prototype.writeUInt32BE),t[220]=m(220,2,l.prototype.writeUInt16BE),t[221]=m(221,4,l.prototype.writeUInt32BE),t[222]=m(222,2,l.prototype.writeUInt16BE),t[223]=m(223,4,l.prototype.writeUInt32BE),t}():d();var e}},2004:function(t,e,i){var s=i(7970);function n(t){var e,i=new Array(256);for(e=0;e<=127;e++)i[e]=a(e);for(e=128;e<=143;e++)i[e]=o(e-128,t.map);for(e=144;e<=159;e++)i[e]=o(e-144,t.array);for(e=160;e<=191;e++)i[e]=o(e-160,t.str);for(i[192]=a(null),i[193]=null,i[194]=a(!1),i[195]=a(!0),i[196]=r(t.uint8,t.bin),i[197]=r(t.uint16,t.bin),i[198]=r(t.uint32,t.bin),i[199]=r(t.uint8,t.ext),i[200]=r(t.uint16,t.ext),i[201]=r(t.uint32,t.ext),i[202]=t.float32,i[203]=t.float64,i[204]=t.uint8,i[205]=t.uint16,i[206]=t.uint32,i[207]=t.uint64,i[208]=t.int8,i[209]=t.int16,i[210]=t.int32,i[211]=t.int64,i[212]=o(1,t.ext),i[213]=o(2,t.ext),i[214]=o(4,t.ext),i[215]=o(8,t.ext),i[216]=o(16,t.ext),i[217]=r(t.uint8,t.str),i[218]=r(t.uint16,t.str),i[219]=r(t.uint32,t.str),i[220]=r(t.uint16,t.array),i[221]=r(t.uint32,t.array),i[222]=r(t.uint16,t.map),i[223]=r(t.uint32,t.map),e=224;e<=255;e++)i[e]=a(e-256);return i}function a(t){return function(){return t}}function r(t,e){return function(i){var s=t(i);return e(i,s)}}function o(t,e){return function(i){return e(i,t)}}e.getReadToken=function(t){var e=s.getReadFormat(t);return t&&t.useraw?function(t){var e,i=n(t).slice();for(i[217]=i[196],i[218]=i[197],i[219]=i[198],e=160;e<=191;e++)i[e]=o(e-160,t.bin);return i}(e):n(e)}},2454:function(t,e,i){"use strict";i.d(e,{er:function(){return dt},hr:function(){return it},xD:function(){return ft},Zj:function(){return pt},Ig:function(){return Et},e1:function(){return yt},rH:function(){return ct},fP:function(){return ht},Nj:function(){return ot},al:function(){return mt},t6:function(){return at},Co:function(){return rt},Ww:function(){return lt},go:function(){return _t},pW:function(){return At},Ux:function(){return gt},PQ:function(){return wt},pH:function(){return ut},v9:function(){return Tt},UI:function(){return bt},Ji:function(){return st},kf:function(){return Nt},i9:function(){return Wt},_O:function(){return nt},nn:function(){return qt},Y:function(){return St},lP:function(){return $t},HP:function(){return Zt},Hf:function(){return vt},W2:function(){return Ut},Uq:function(){return Ft},C9:function(){return zt},Wc:function(){return Kt},AP:function(){return Gt},$e:function(){return Ht},o:function(){return kt},dL:function(){return Ct},wB:function(){return Pt},Kq:function(){return Rt},Uk:function(){return Mt},sZ:function(){return Bt},vf:function(){return jt},DF:function(){return Lt}});var s=i(5710);var n=class{constructor(){this.name="background",this.id=s.A.layers.background[1],this.layer=s.A.layers.background[0],this.x=0,this.y=0}get width(){return st.viewport.width}get height(){return st.viewport.height}render(){nt.save(),nt.fillStyle=s.A.map.color,nt.fillRect(this.x,this.y,this.width,this.height),nt.restore()}init(){Mt.add(this.layer,{id:this.id,_function:this.render.bind(this)})}};var a=class{constructor(){this.name="boundings",this.id=s.A.layers.boundings[1],this.layer=s.A.layers.boundings[0]}get width(){return st.viewport.width}get height(){return st.viewport.height}render(){if(nt.save(),nt.fillStyle=s.A.boundings.color,nt.globalAlpha=s.A.boundings.alpha,bt.xOffset<=0&&nt.fillRect(0,0,-bt.xOffset,this.height),s.A.map.width-bt.xOffset<=this.width){const t=Math.max(0,-bt.yOffset);nt.fillRect(s.A.map.width-bt.xOffset,t,this.width-(s.A.map.width-bt.xOffset),this.height-t)}if(bt.yOffset<=0&&nt.fillRect(-bt.xOffset,0,this.width+bt.xOffset,-bt.yOffset),s.A.map.height-bt.yOffset<=this.height){const t=Math.max(0,-bt.xOffset);let e=0;s.A.map.width-bt.xOffset<=this.width&&(e=this.width-(s.A.map.width-bt.xOffset)),nt.fillRect(t,s.A.map.height-bt.yOffset,this.width-t-e,this.height-(s.A.map.height-bt.yOffset))}nt.restore()}init(){Mt.add(this.layer,{id:this.id,_function:this.render.bind(this)})}},r=i(3136),o=i(3919);class h extends o.A{constructor(){super(0,0,0),this.name="camera",this.id=s.A.layers.camera[1],this.layer=s.A.layers.camera[0],this.target=null,this.xVel=0,this.yVel=0,this.isInit=!1,this.x1=null,this.y1=null}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position=new r.A(t,this.y)}set y(t){this.position=new r.A(this.x,t)}toMapMiddle(){this.setTo(s.A.map.width/2,s.A.map.height/2)}update(){if(this.target=Pt.player,this.target?.isAlive){const t=this.distanceTo(this.target),e=this.angleTo(this.target),i=Math.min(.01*t*Mt.delta,t);t>.05?(this.xVel=i*Math.cos(e),this.yVel=i*Math.sin(e),this.position.add(this.xVel,this.yVel)):(this.x=this.target.x,this.y=this.target.y),this.x1=this.x,this.y1=this.y}else null!==this.x1&&null!==this.y1?this.position=new r.A(this.x1,this.y1):this.toMapMiddle();this.updatePhysics()}init(){Mt.add(this.layer,{id:this.id,_function:this.update.bind(this)})}}var l=h,c=i(9421);var _=class{constructor(){this.id=s.A.layers.dayNight[1],this.layer=s.A.layers.dayNight[0],this.state=1,this.nightCount=0}setState(t){this.state=t}showDayNotification(){Ht.add("The morning will start soon!",null,"day_icon")}showNightNotification(){Ht.add("The night will begin soon!",null,"night_icon")}render(){this.nightCount+=((0===this.state?1:0)-this.nightCount)/160;const t=nt.getTransform(),e=`rgba(${[24,0,82,.3].map((t=>t*this.nightCount)).join(", ")})`;nt.setTransform(1,0,0,1,0,0),nt.fillStyle=e,ot.setStyles("background",e),nt.fillRect(0,0,st.width,st.height),nt.setTransform(t)}init(){Mt.add(this.layer,{id:this.id,_function:this.render.bind(this)})}},d=i(9590);var u=class{constructor(){this.$wrapper=new d.A("#debug_panel_wrapper")}getTemplate(t,e){return`\n        <li class="debug-panel-item">\n            <span>${t}</span>\n            <span>${e}</span>\n        </li>\n        `}create(t,e){const i=this.getTemplate(t,e);this.$wrapper.insert(i)}update(){if(yt.isHidden)return;this.$wrapper.html="";const t=Mt.nowUpdate-1e3/s.A.serverUpdateRate,e=Pt.player.t2-Pt.player.t1,i=t-Pt.player.t1,n=e/i;this.create("FPS",Mt.fps.toFixed(2)),this.create("PING",Bt.ping||"..."),this.create("DELTA",Mt.delta),this.create("WS_PROTOCOL",s.A.protocol.ws),this.create("HOST",s.A.host),this.create("PLAYERS",Pt.players.size),this.create("ANIMALS",Tt.animals.size),this.create("OBJECTS",kt.objects.size),this.create("PARTICLES",Ct.particles.size),this.create("DIF_TICK_2_1",Math.abs(e)),this.create("DIF_TICK_TIME",Math.abs(i).toFixed(2)),this.create("TICK_RATIO",Math.abs(n).toFixed(2))}};var f=class{constructor(){this.name="entitiesInfo",this.id=s.A.layers.entitiesInfo[1],this.layer=s.A.layers.entitiesInfo[0],this.isInit=!1}render(){const t=[...Pt.list,...kt.list,...Tt.list];for(let e=0;e<t.length;e++){const i=t[e];i.renderNickname&&i.renderNickname(),i.renderHealthbar&&i.renderHealthbar(),i.renderChat&&i.renderChat()}}init(){Mt.add(this.layer,{id:this.id,_function:this.render.bind(this)})}};var p=class{constructor(){this.name="background",this.id=s.A.layers.grid[1],this.layer=s.A.layers.grid[0],this.x=0,this.y=0,this.isInit=!1}get width(){return st.viewport.width}get height(){return st.viewport.height}render(){nt.save(),nt.strokeStyle=s.A.grid.color,nt.lineWidth=s.A.grid.width,nt.globalAlpha=s.A.grid.alpha,nt.beginPath();for(let t=-bt.x;t<this.width;t+=this.height/s.A.grid.difX)t>0&&(nt.moveTo(t,0),nt.lineTo(t,this.height));for(let t=-bt.y;t<this.height;t+=this.height/s.A.grid.difY)t>0&&(nt.moveTo(0,t),nt.lineTo(this.width,t));nt.stroke(),nt.restore(),bt.xOffset=bt.x-st.viewport.width/2,bt.yOffset=bt.y-st.viewport.height/2}init(){Mt.add(this.layer,{id:this.id,_function:this.render.bind(this)})}},m=i(2705),y=(i(6355),i(5160));var g=class{constructor(){this.$itemInfoHolder=new d.A("#item_info_holder"),this.$itemInfoImage=new d.A("#item_info_image"),this.$itemInfoName=new d.A("#item_info_name"),this.$itemInfoCount=new d.A("#item_info_count"),this.$itemInfoDescription=new d.A("#item_info_description"),this.$itemInfoReq=new d.A("#item_info_req")}getItemReqLayout(t,e){return`\n        <div class="item-info-req-item">\n            <img class="item-info-req-image" src="./assets/icons/${t="wood"===t?"tree":t}_icon.png">\n            <span class="item-info-req-text">${e}</span>\n        </div>\n        `}setItemIcon(t){if(this.$itemInfoCount.hide(),this.$itemInfoReq.hide(),t.group){const e=(0,m.A)(t,/windmill/.test(t.name),/berry/.test(t.name)?3:null);if(t.group.limit){const e=t.group.limit*(jt.hasModule("more_buildings")?2:1);this.$itemInfoCount.show(),this.$itemInfoCount.text=`${Pt.player.itemsCount[t.group.id]||0}/${e}`}if(t.req?.length>1){this.$itemInfoReq.show(),this.$itemInfoReq.html="";for(let e=0;e<t.req.length;e+=2){const i=this.getItemReqLayout(t.req[e],t.req[e+1]);this.$itemInfoReq.insert(i)}}return this.$itemInfoImage.setStyles("transform","none"),this.$itemInfoImage.classes.add("is-item"),void(this.$itemInfoImage.element.src=e.toDataURL())}const e=(0,y.A)(t);this.$itemInfoImage.setStyles("transform",`rotate(225deg) translateY(${t.cssTranslate}px) scale(${t.cssScale/1.75})`),this.$itemInfoImage.classes.remove("is-item"),this.$itemInfoImage.element.src=e.image.src}setCapIcon(t){this.$itemInfoReq.hide(),this.$itemInfoImage.setStyles("transform","rotate(0deg)"),this.$itemInfoImage.classes.add("is-item"),this.$itemInfoCount.text=t.type,this.$itemInfoImage.element.src=t.iconSrc}setName(t){this.$itemInfoName.html=t}setDescription(t){this.$itemInfoDescription.text=t}show(t){t&&(t.isHat||t.isModule?this.setCapIcon(t):this.setItemIcon(t),this.setName(t.name),this.setDescription(t.desc),this.$itemInfoHolder.show())}hide(){this.$itemInfoHolder.hide()}};var E=function(t,e=1e3){const i=["k","m","b","t","q"];return t===Number.POSITIVE_INFINITY?"Infinity":t>=1e18&&e<=1e18?t.toExponential(2).replace(/\+/g,""):t>=1e15&&e<=1e15?(t/1e15).toFixed(1)+i[4]:t>=1e12&&e<=1e12?(t/1e12).toFixed(1)+i[3]:t>=1e9&&e<=1e9?(t/1e9).toFixed(1)+i[2]:t>=1e6&&e<=1e6?(t/1e6).toFixed(1)+i[1]:t>=1e3&&e<=1e3?(t/1e3).toFixed(1)+i[0]:t.toString().replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")};var w=class{constructor(){this.$list=new d.A("#leader_board_list"),this.chunkSize=5}get contentTemplate(){return'\n        <span class="table-title rank-title"></span>\n        <span class="table-title nickname-title">\n            <span></span>\n        </span>\n        <span class="table-title gold-title"></span>\n        <span class="table-title kill-title"></span>\n        '}addItem(t,e,i,s,n){const a=document.createElement("li");a.classList.add("table-titles","no-border","leader-board-item"),t===Pt.player.id&&a.classList.add("my-leader-board-item"),a.insertAdjacentHTML("beforeend",this.contentTemplate);const r=a.querySelectorAll(".table-title");r[0].insertAdjacentText("beforeend",`#${e}`),r[1].querySelector("span").insertAdjacentText("beforeend",i),r[2].insertAdjacentText("beforeend",E(s)),r[3].insertAdjacentText("beforeend",n),this.$list.element.appendChild(a)}update(t){this.$list.html="",this.myData=t.slice(t.length-this.chunkSize,t.length),Rt.updateRank(this.myData[1]),t=t.slice(0,t.length-this.chunkSize);for(let e=0;e<t.length;e+=this.chunkSize)this.addItem(...t.slice(e,e+this.chunkSize));t.includes(this.myData[0])||this.addItem(...this.myData)}};var A=class{constructor(){this.id=s.A.layers.minimap[1],this.layer=s.A.layers.minimap[0],this.canvas=document.getElementById("minimap_canvas"),this.context=this.canvas.getContext("2d"),this.points=[]}get width(){return s.A.minimap.width}get height(){return s.A.minimap.height}resize(){this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width=`${this.width}px`,this.canvas.style.height=`${this.height}px`}getPosition(t,e){return{x:t/s.A.map.width*this.width,y:e/s.A.map.height*this.height}}update(t){this.points=t}renderPoint(t){this.context.fillStyle=s.A.minimap.pointColors[t],this.context.beginPath(),this.context.arc(0,0,s.A.minimap.pointScale,0,2*Math.PI),this.context.closePath(),this.context.fill()}render(){if(this.context.clearRect(0,0,this.width,this.height),!Pt.player?.isAlive)return;for(let t=0;t<this.points.length;t+=3){const e=this.points.slice(t,t+3),i=this.getPosition(e[0],e[1]);this.context.save(),this.context.globalAlpha=.6,this.context.translate(i.x,i.y),this.renderPoint(e[2]),this.context.restore()}this.context.save();const t=this.getPosition(Pt.player.x,Pt.player.y);this.context.translate(t.x,t.y),this.renderPoint(0),this.context.restore()}init(){this.resize(),Mt.add(this.layer,{id:this.id,_function:this.render.bind(this)})}};class v{constructor(t,e){this.id=t,this.element=e,this.bar=this.element.querySelector(".notification-bar-inner"),this.lifeTime=1e4,this.staticLifeTime=this.lifeTime}get barWidth(){return this.lifeTime/this.staticLifeTime*100}destroy(){}update(){if(this.lifeTime<=1e3&&!/hide/.test(this.element.style.animation)&&(this.element.style.animation="notification-hide 0.4s forwards"),this.lifeTime<=0)return this.element.remove(),this.destroy();this.lifeTime-=Mt.delta,this.bar.style.width=`${this.barWidth}%`}}var M=class{constructor(){this.id=s.A.layers.notifications[1],this.layer=s.A.layers.notifications[0],this.$list=new d.A("#notifications_list"),this.notifications=new Map}getNotificationLayout(t,e,i,s){return`\n        <li class="ui-element notification-item" data-notification-id="${t}">\n            <div class="notification-item-header">\n                <img class="notification-icon" src="./assets/icons/${s}.png">\n                <span class="notification-text" style="color: ${i}">${e}</span>\n            </div>\n\n            <div class="notification-bar-wrapper">\n                <div class="notification-bar-inner"></div>\n            </div>\n         </li>\n        `}add(t,e,i){const s=parseInt(Math.random()*(Date.now()/1e3)-1e3*Math.random()),n=this.getNotificationLayout(s,t,e,i);this.$list.insert(n);let a=document.querySelector(`.notification-item[data-notification-id="${s}"]`);a=new v(s,a),a.destroy=()=>{this.remove(s)},this.notifications.set(s,a)}remove(t){this.notifications.delete(t)}update(){this.notifications.forEach((t=>{t.update()}))}init(){window.notifications=this,Mt.add(this.layer,{id:this.id,_function:this.update.bind(this)})}},b=i(3002),x=i(8666),I=i(6021);var O=class{constructor(){this.$food=new d.A("#food_display"),this.$gold=new d.A("#gold_display"),this.$wood=new d.A("#wood_display"),this.$stone=new d.A("#stone_display"),this.$nickname=new d.A("#profile_nickname"),this.$rank=new d.A("#profile_rank"),this.$healtbar=new d.A("#profile_health_bar"),this.$levelbar=new d.A("#profile_level_bar"),this.profileCanvas=document.getElementById("profile_canvas"),this.profileContext=this.profileCanvas.getContext("2d")}get player(){return Pt.player}updateNickname(){this.$nickname.text=(0,x.A)(this.player.nickname)}updateRank(t){this.$rank.text=`#${t}`}updateResources(){this.$gold.text=E(this.player.gold),this.$food.text=E(this.player.food),this.$wood.text=E(this.player.wood),this.$stone.text=E(this.player.stone)}updateHealthBar(){this.$healtbar.setAttr("health",this.player.health);const t=this.player.health/this.player.maxHealth*100;this.$healtbar.setStyles("width",`${t}%`)}updateLevelBar(){this.$levelbar.setAttr("level",this.player.level),this.$levelbar.setAttr("xp",this.player.xp),this.$levelbar.setAttr("maxXP",this.player.maxXP);const t=this.player.xp/this.player.maxXP*100;this.$levelbar.setStyles("width",`${t}%`)}updateProfileCanvas(){if(!this.player?.isAlive)return;const t=this.profileCanvas.width/2,e=Math.PI/4,i=this.player.buildIndex<0&&this.player.weapon.handXOffsets||[0,0],n=this.player.buildIndex<0&&this.player.weapon.handYOffsets||[0,0],a=this.player.lockDir?this.player.dir:this.player.mouseDir,r=s.A.player;if(this.profileContext.clearRect(0,0,this.profileCanvas.width,this.profileCanvas.height),this.player.buildIndex<0&&!this.player.weapon.aboveHand&&this.player.weapon){const e=(0,y.A)(this.player.weapon);e.isLoaded&&(this.profileContext.save(),this.profileContext.translate(t,t),this.profileContext.rotate(a+this.player.dirPlus-(this.player.weapon.plusRotate||0)),this.profileContext.scale(.35,.35),this.profileContext.drawImage(e.image,this.player.scale/2-this.player.weapon.xOffset-this.player.weapon.length/2,this.player.scale/2-this.player.weapon.yOffset-this.player.weapon.width/2,this.player.weapon.length,this.player.weapon.width),this.profileContext.restore())}if(this.profileContext.save(),this.profileContext.translate(t,t),this.profileContext.rotate(a+this.player.dirPlus),this.profileContext.scale(.35,.35),this.profileContext.strokeStyle=r.outlineColor,this.profileContext.fillStyle=r.colors[this.player.skinIndex],this.profileContext.lineWidth=r.outlineWidth,this.profileContext.lineJoin="miter",(0,I.A)(this.player.scale*Math.cos(e)+i[0],this.player.scale*Math.sin(e)+n[0],r.handScale,this.profileContext),this.profileContext.fill(),this.profileContext.stroke(),(0,I.A)(this.player.scale*Math.cos(-e)+i[1],this.player.scale*Math.sin(-e)+n[1],r.handScale,this.profileContext),this.profileContext.fill(),this.profileContext.stroke(),this.player.buildIndex>=0){const t=b.A[this.player.buildIndex],e=(0,m.A)(t,/windmill/.test(t.name));t&&this.profileContext.drawImage(e,this.player.scale-t.holdOffset,-e.width/2)}if((0,I.A)(0,0,this.player.scale,this.profileContext),this.profileContext.fill(),this.profileContext.stroke(),this.player.hatIndex>0&&this.player.hatImage){let t=this.player.hatImage;t.isLoaded&&(this.profileContext.rotate(Math.PI/2),this.profileContext.rotate(this.player.skinRotate),this.profileContext.drawImage(t.image,-this.player.hat.scale/2,-this.player.hat.scale/2,this.player.hat.scale,this.player.hat.scale))}this.profileContext.restore()}};var P=class{constructor(){this.fps=0,this.delta=0,this.layers=new Map([[1,new Map],[2,new Map],[3,new Map],[4,new Map]]),this.nowUpdate=0,this.lastUpdate=Date.now()}add(t,{id:e,delay:i=!1,_function:s}){return this.layers.get(t).set(e,{layer:t,id:e,delay:i,_function:s,lastUpdate:Date.now()})}remove(t,e){this.layers.get(t).delete(e)}update(){this.nowUpdate=Date.now(),this.fps+=(1e3/Math.max(Date.now()-this.lastUpdate,1)-this.fps)/10,this.delta=this.nowUpdate-this.lastUpdate,this.lastUpdate=this.nowUpdate,nt.clearRect(0,0,st.viewport.width,st.viewport.height);const t=this.layers.values();for(let e=0;e<this.layers.size;e++){t.next().value.forEach((t=>{if(t.delay){if(Date.now()-t.lastUpdate<t.delay)return;t.lastUpdate=Date.now()}t._function(this.delta)}))}Rt.updateProfileCanvas(),St.update(),requestAnimationFrame(this.update.bind(this))}},D=i(1490),k=i(3667);class C{constructor({id:t,name:e,width:i,height:s,health:n,scale:a,reverseSpriteAnim:r,spriteFrameSpeed:o,model:h}){this.id=t,this.name=e,this.width=i,this.height=s,this.health=n,this.scale=a,this.reverseSpriteAnim=r,this.spriteFrameSpeed=o,this.model=h,this.isAnimal=!0}}var T=[new C({id:0,name:"Cow",health:400,width:195,height:220,scale:75,spriteFrameSpeed:75,model:{head:["cow/head/cow_head_passive","cow/head/cow_head_scared"],body:["cow/cow_body"],tail:["cow/tail/cow_tail_1","cow/tail/cow_tail_2","cow/tail/cow_tail_3","cow/tail/cow_tail_4","cow/tail/cow_tail_5","cow/tail/cow_tail_6","cow/tail/cow_tail_7","cow/tail/cow_tail_8"]}}),new C({id:1,name:"Wolf",health:950,width:195,height:220,scale:75,model:{head:["wolf/head/wolf_head_passive","wolf/head/wolf_head_aggresive","wolf/head/wolf_head_bite"],body:["wolf/wolf_body"],tail:["wolf/wolf_tail"]}})],L=i(4457);var B=function(t){const e=Ft.get("animals");let i=e[t];return i||(e[t]={},i=e[t],i.image=new Image,i.image.onload=()=>{i.isLoaded=!0},i.image.src=`./assets/animals/${t}.png`),i};var U=class{constructor(t,e,i,s){this.sprites=t,this.reverseSpriteAnim=e,this.spriteFrameSpeed=i,this.manualSprites=s,this.currentImage=null,this.spriteIndex=0,this.aspriteReverse=!1,this.spriteTime=null}setSprite(t){this.spriteIndex=t}update(){if(this.manualSprites)return void(this.currentImage=B(this.sprites[this.spriteIndex]));let t=null;this.reverseSpriteAnim?this.spriteIndex>=this.sprites.length-1?this.spriteReverse=!0:this.spriteIndex<1&&(this.spriteReverse=!1):(this.spriteReverse=!1,this.spriteIndex>=this.sprites.length&&(this.spriteIndex=0)),t=this.sprites[this.spriteIndex],(!this.spriteTime||Date.now()-this.spriteTime>=this.spriteFrameSpeed)&&(this.spriteIndex+=this.spriteReverse?-1:1,this.spriteTime=Date.now()),this.currentImage=B(t)}};class S extends o.A{constructor(t){super(0,0,0),this.setTo(t[1],t[2]),this.id=t[0],this.data=T[t[4]],this.nickname=this.data.nickname,this.t1=null,this.t2=null,this.x1=this.x,this.y1=this.y,this.x2=this.x1,this.y2=this.y1,this.dir=t[3],this.dir1=null,this.dir2=null,this.health=t[5],this.maxHealth=this.data.health,this.moodState=t[6],this.head=new U(this.data.model.head,this.data.reverseSpriteAnim,this.data.spriteFrameSpeed,!0),this.headDir=0,this.body=new U(this.data.model.body,this.data.reverseSpriteAnim,this.data.spriteFrameSpeed),this.tail=new U(this.data.model.tail,this.data.reverseSpriteAnim,this.data.spriteFrameSpeed),this.head.setSprite(this.moodState),this.dt=0,this.isHeadLookActive=!1,this.lastHeadLookActive=Date.now(),this.headLookActiveDelay=5e3,this.headLookState=0,this.changeLookState=2e3,this.staticChangeLookState=this.changeLookState,this.resetHeadDirTime=Date.now(),this.effectsManager=new L.A(this),this.effectsIDs=0,this.active=!0}setData(t){this.dt=0,this.x1=this.x,this.y1=this.y,this.x2=t[1],this.y2=t[2],this.dir1=null!==this.dir2?this.dir2:t[3],this.dir2=t[3],this.speed=Math.hypot(this.y2-this.y1,this.x2-this.x1),this.t1=null!==this.t2?this.t2:Date.now(),this.t2=Date.now(),this.health=t[4],this.active=!0,this.moodState=t[5],this.effectsIDs=t[6]?.toString()}renderBody(){if(!this.body.currentImage.isLoaded)return;const t=-this.data.width/2,e=-this.data.height/2;nt.rotate(-Math.PI/2),nt.drawImage(this.body.currentImage.image,t,e,this.data.width,this.data.height)}renderHead(){if(this.head.setSprite(this.moodState),!this.head.currentImage.isLoaded)return;const t=-this.data.width/2+0,e=-this.data.height/2+100;nt.rotate(this.headDir),nt.rotate(-Math.PI/2),nt.drawImage(this.head.currentImage.image,t,e,this.data.width,this.data.height)}renderTail(){if(!this.tail.currentImage.isLoaded)return;const t=-this.data.width/2-0,e=-this.data.height/2-80;nt.rotate(-Math.PI/2),nt.drawImage(this.tail.currentImage.image,t,e,this.data.width,this.data.height)}renderHealthbar(){if(!this.health)return;const t=s.A.animals.healthbar;nt.save(),nt.translate(this.x-bt.xOffset,this.y-bt.yOffset),nt.fillStyle=t.outlineColor,nt.roundRect(-t.width-t.padding+t.xOffset,t.yOffset,2*t.width+2*t.padding,t.height,t.radius),nt.fill();const e=nt.createLinearGradient(-t.width+t.xOffset,t.yOffset+t.padding+(t.height-2*t.padding)/2,0,t.height-2*t.padding);e.addColorStop(0,t.color[0]),e.addColorStop(1,t.color[1]),nt.fillStyle=e,nt.roundRect(-t.width+t.xOffset,t.yOffset+t.padding,2*t.width*(this.health/this.maxHealth),t.height-2*t.padding,t.radius-1),nt.fill(),nt.restore()}render(){this.active&&(this.head.update(),this.body.update(),this.tail.update(),nt.save(),nt.translate(this.x-bt.xOffset,this.y-bt.yOffset),nt.rotate(this.dir),this.renderTail(),nt.restore(),nt.save(),nt.translate(this.x-bt.xOffset,this.y-bt.yOffset),nt.rotate(this.dir),this.renderBody(),nt.restore(),nt.save(),nt.translate(this.x-bt.xOffset,this.y-bt.yOffset),nt.rotate(this.dir),this.renderHead(),nt.restore())}update(){if(this.active)if(0===this.moodState&&parseInt(this.speed)<=5?((!this.resetHeadDirTime||Date.now()-this.resetHeadDirTime>=15e3)&&(this.headDir=0,this.isHeadLookActive=!1,this.lastHeadLookActive=Date.now(),this.resetHeadDirTime=Date.now()),(!this.lastHeadLookActive||Date.now()-this.lastHeadLookActive>=this.headLookActiveDelay)&&(this.isHeadLookActive=!this.isHeadlookActive,this.headLookActiveDelay=5e3,this.lastHeadLookActive=Date.now()),this.isHeadLookActive&&(this.changeLookState>0&&0===this.headLookState?(this.changeLookState-=Math.min(Mt.delta,100),this.headLookState=0,this.changeLookState<=0&&(this.headLookState=1,this.headLookActiveDelay/=3)):this.changeLookState<this.staticChangeLookState&&1===this.headLookState&&(this.changeLookState+=Math.min(Mt.delta,100),this.headLookState=1,this.changeLookState>=this.staticChangeLookState&&(this.headLookState=0,this.headLookActiveDelay/=2)),0===this.headLookState?this.headDir-=15e-6*Mt.delta:this.headDir+=15e-6*Mt.delta),this.headDir=Math.min(Math.max(this.headDir,-1),1)):this.headDir=0,this.render(),this.effectsManager.update(),this.effectsIDs){const t=this.effectsIDs.match(/../g);if(!t)return this.effectsManager.effects.clear();this.effectsManager.effects.forEach(((e,i)=>{t.includes(i.toString())||e.destroy()}));for(let e=0;e<t.length;e++){const i=parseInt(t[e]);this.effectsManager.add(i)}}else this.effectsManager.effects.clear()}}var R=S;var W=class{constructor(){this.id=s.A.layers.animalsManager[1],this.layer=s.A.layers.animalsManager[0],this.animals=new Map,this.lastUpdate=null}get list(){return[...this.animals.values()]}add(t){return this.animals.set(t[0],new R(t)),this.animals.get(t[0])}remove(t){this.animals.delete(t)}updateData(t){for(let e=0;e<t.length;e+=7){const i=this.animals.get(+t[e]),s=t.slice(e,e+7);i.setData(s)}}update(){this.animals.forEach((t=>{if(!t.active)return;const e=Mt.nowUpdate-1e3/s.A.serverUpdateRate,i=(t.t2-t.t1)/(e-t.t1);t.dt+=Mt.delta;const n=Math.min(1.7,t.dt/170);let a=t.x2-t.x1;t.x=t.x1+a*n,a=t.y2-t.y1,t.y=t.y1+a*n,t.dir=(0,k.A)(t.dir2,t.dir1,Math.min(1.2,i)),t.update()}))}init(){Mt.add(this.layer,{id:this.id,_function:this.update.bind(this)})}},j=i(4643),$=[{id:0,name:"tree",spikes:8,layers:2,divScales:[1,.5],colors:[["#78ac4d","#80b654"]],outlineColor:"#474747",outlineWidth:7,layer:"tree",gatherParticlesAmount:3},{id:1,name:"stone",spikes:4,layers:2,divScales:[1,.6],colors:[["#828282","#949494"]],outlineColor:"#474747",outlineWidth:7,layer:"stone",gatherParticlesAmount:3},{id:1,name:"gold",spikes:4,layers:2,divScales:[1,.6],colors:[["#d0b53e","#d5bd53"]],outlineColor:"#474747",outlineWidth:7,layer:"stone",gatherParticlesAmount:3},{id:3,name:"berrybush",spikes:8,berries:5,colors:[["#78ac4d","#c15555"]],outlineColor:"#474747",outlineWidth:7,layer:"food",gatherParticlesAmount:3,maxBerries:5},{id:4,name:"blueberrybush",spikes:8,berries:5,colors:[["#78ac4d","#5869a7"]],outlineColor:"#474747",outlineWidth:7,layer:"food",gatherParticlesAmount:3,maxBerries:5}],K=i(2618);var q=function(t){const e=`${t.type}_${t.scale}_0`;if(!zt.has(e)){t=JSON.parse(JSON.stringify(t));const i=document.createElement("canvas");i.width=i.height=2.1*t.scale+t.data.outlineWidth;const s=i.getContext("2d"),n=t.data.colors[0];if(s.translate(i.width/2,i.height/2),s.strokeStyle=t.data.outlineColor,s.lineWidth=t.data.outlineWidth,0===t.type)for(let e=0;e<t.data.layers;++e){const i=t.scale*t.data.divScales[e];(0,K.A)(s,t.data.spikes-e,i,.7*i),s.fillStyle=n[e],s.fill(),!e&&s.stroke()}else if(1===t.type||2===t.type)for(let e=0;e<t.data.layers;e++){const i=1.25*t.scale*t.data.divScales[e];s.fillStyle=n[e],(0,K.A)(s,t.data.spikes,i,.7*i),s.fill(),!e&&s.stroke()}else 3!==t.type&&4!==t.type||(s.fillStyle=n[0],(0,K.A)(s,t.data.spikes,1.1*t.scale,.75*t.scale),s.fill(),s.stroke());zt.set(e,i)}return zt.get(e)};class H extends o.A{constructor(t){super(0,0,t[4]),this.setTo(t[1],t[2]),this.id=t[0],this.dir=t[3],this.type=t[5],this.data=t[6]||0===t[6]?b.A[t[5]]:$[t[5]],this.ownerID=t[6],this.berries=t[7]||0,this.health=t[8],this.maxHealth=this.data.health,this.dir2=this.dir,this.xWiggle=0,this.yWiggle=0,this.isItem=Boolean(t[6]||0===t[6]),this.lastChangeHealth=null}get isAlly(){return Nt.isMemeber(this.ownerID)}changeHealth(t){this.health=t,this.lastChangeHealth=Date.now()}doGatherWiggle(t){if(this.xWiggle+=s.A.gatherWiggle*Math.cos(t),this.yWiggle+=s.A.gatherWiggle*Math.sin(t),!this.isItem){const e=this.x+this.scale/1.25*-Math.cos(t),i=this.y+this.scale/1.25*-Math.sin(t);for(let n=0;n<this.data.gatherParticlesAmount;n++){const n=t+[Math.random(),-Math.random()][(0,j.A)(0,1)],a=t+[Math.random(),-Math.random()][(0,j.A)(0,1)];Ct.add(e,i,this.scale/7,350,s.A.gatherPacrticlesSpeed,-Math.cos(n),-Math.sin(a),(()=>{const t=q(this);nt.scale(.18,.18),nt.drawImage(t,-t.width/2,-t.height/2)}))}}}updateBerries(t){this.isItem&&3!==this.type||(this.berries=t)}renderHealthbar(){if(!this.isItem||!this.health)return;const t=s.A.buildings.healthbar;if(!this.lastChangeHealth||Date.now()-this.lastChangeHealth>=t.hideDelay)return;nt.save(),nt.translate(this.x+this.xWiggle-bt.xOffset,this.y+this.yWiggle-bt.yOffset),nt.fillStyle=t.outlineColor,nt.roundRect(-t.width-t.padding+t.xOffset,this.scale+t.yOffset,2*t.width+2*t.padding,t.height,t.radius),nt.fill();const e=nt.createLinearGradient(-t.width+t.xOffset,t.yOffset+t.padding+(t.height-2*t.padding)/2,0,t.height-2*t.padding);e.addColorStop(0,this.isAlly?t.allyColor[0]:t.enemyColor[0]),e.addColorStop(1,this.isAlly?t.allyColor[1]:t.enemyColor[1]),nt.fillStyle=e,nt.roundRect(-t.width+t.xOffset,this.scale+t.yOffset+t.padding,2*t.width*(this.health/this.maxHealth),t.height-2*t.padding,t.radius-1),nt.fill(),nt.restore()}render(){let t=null;if(t=this.isItem?(0,m.A)(this.data):q(this),this.data.turnSpeed&&(this.dir2+=this.data.turnSpeed*Mt.delta),nt.save(),nt.translate(this.x+this.xWiggle-bt.xOffset,this.y+this.yWiggle-bt.yOffset),nt.rotate(this.dir),nt.drawImage(t,-t.width/2,-t.height/2),this.isItem){if(/windmill/.test(this.data.name)){nt.strokeStyle=this.data.outlineColor,nt.lineWidth=this.data.outlineWidth,nt.rotate(this.dir2);for(let t=0;t<this.data.blades;t++){const e=1.5*this.data.scale,i=this.data.scale/2.25;nt.fillStyle=this.data.colors[3],nt.rotate(Math.PI/2*t),nt.roundRect(-e,-i/2,2*e,i,8),nt.fill(),nt.stroke()}nt.fillStyle=this.data.colors[2],nt.rotate(this.dir2),(0,K.A)(nt,this.data.sides-1,this.data.scale/2*1.1,this.data.scale/2*.8),nt.fill(),nt.stroke()}}else if((3===this.type||4===this.type)&&this.berries>0){const t=0,i=2*Math.PI/this.data.maxBerries;for(var e=0;e<this.berries;++e){const s=this.scale/2.9;nt.fillStyle=this.data.colors[t][1],nt.strokeStyle=this.data.outlineColor,nt.lineWidth=this.data.outlineWidth,(0,I.A)(s*Math.cos(i*e),s*Math.sin(i*e),11,nt),nt.fill(),nt.stroke()}}nt.restore()}update(){this.xWiggle&&(this.xWiggle*=Math.pow(.99,Mt.delta)),this.yWiggle&&(this.yWiggle*=Math.pow(.99,Mt.delta)),this.render()}}var N=H;var F=class{constructor(){this.id=s.A.layers.objectsManager[1],this.layer=s.A.layers.objectsManager[0],this.bpId=s.A.layers.objectsManagerBP[1],this.bpLayer=s.A.layers.objectsManagerBP[0],this.objects=new Map,this.renderLayers=new Map([["items",{}],["stone",{}],["food",{}],["tree",{}]]),this.renderLayersBP=new Map([["traps",{}]])}get list(){return[...this.objects.values()]}reset(){this.objects=new Map,this.renderLayers=new Map([["items",{}],["stone",{}],["food",{}],["tree",{}]]),this.renderLayersBP=new Map([["traps",{}]])}add(t){this.objects.set(t[0],new N(t));const e=this.objects.get(t[0]);return this.renderLayers.has(e.data.layer)?this.renderLayers.get(e.data.layer)[e.id]=e.update.bind(e):this.renderLayersBP.has(e.data.layer)&&(this.renderLayersBP.get(e.data.layer)[e.id]=e.update.bind(e)),e}remove(t){const e=this.objects.get(t);e.data?.layer&&(this.renderLayers.has(e.data.layer)&&delete this.renderLayers.get(e.data.layer)[e.id],this.renderLayersBP.has(e.data.layer)&&delete this.renderLayersBP.get(e.data.layer)[e.id]),this.objects.delete(t)}updateBP(){this.renderLayersBP.forEach((t=>{const e=[...Object.values(t)];for(let t=0;t<e.length;t++)e[t]()}))}update(){this.renderLayers.forEach((t=>{const e=[...Object.values(t)];for(let t=0;t<e.length;t++)e[t]()}))}init(){Mt.add(this.bpLayer,{id:this.bpId,_function:this.updateBP.bind(this)}),Mt.add(this.layer,{id:this.id,_function:this.update.bind(this)})}};class z extends o.A{constructor(t,e,i,s,n,a,r,o,h){super(0,0,s),this.setTo(e,i),this.id=t,this.lifeTime=this.maxLifeTime=n,this.speed=a,this.xAngle=r,this.yAngle=o,this.render=h,this.x1=this.x,this.y1=this.y,this.x2=this.x1,this.y2=this.y1,this.dt=0,this.createdTime=Date.now()}update(){if(this.dt=0,this.lifeTime<=0)return Ct.remove(this.id);this.lifeTime-=Mt.delta;const t=this.speed*Mt.delta;this.acceleration.add(t*this.xAngle,t*this.yAngle),this.x1=this.x,this.y1=this.y,this.updatePhysics(),this.x2=this.x,this.y2=this.y,nt.save(),nt.globalAlpha=Math.max(this.lifeTime/this.maxLifeTime,.5),nt.translate(this.x-bt.xOffset,this.y-bt.yOffset),nt.rotate(this.angle),this.render(),nt.restore()}}var Z=z;var G=class{constructor(){this.id=s.A.layers.particlesManager[1],this.layer=s.A.layers.particlesManager[0],this.particles=new Map}get list(){return[...this.particles.values()]}reset(){this.particles=new Map}add(t,e,i,s,n,a,r,o){const h=parseInt(Math.random()*(Date.now()/1e3)-1e3*Math.random());this.particles.set(h,new Z(h,t,e,i,s,n,a,r,o))}remove(t){this.particles.delete(t)}update(){this.particles.forEach((t=>{t.dt+=Mt.delta;const e=Math.min(1.7,t.dt/170);let i=t.x2-t.x1;t.x=t.x1+i*e,i=t.y2-t.y1,t.y=t.y1+i*e,t.update()}))}init(){Mt.add(this.layer,{id:this.id,_function:this.update.bind(this)})}},Y=i(4452),X=i(2559);class J extends o.A{constructor(t,e,i,n,a){super(i,n,0),this.id=t,this.text=e,this.color=s.A.animatedText.colors[a||0],this._scale=25,this.staticScale=this._scale,this.maxScale=1.5*this.staticScale,this.scaleSpeed=.03,this._lifeTime=1e3,this.staticLifeTime=this._lifeTime,this.speed=.02,this._alpha=1,this.active=!0}get lifeTime(){return Math.max(Math.min(this._lifeTime,this.staticLifeTime),0)}set lifeTime(t){this._lifeTime=t}get scale(){return Math.max(Math.min(this._scale,this.maxScale),0)}set scale(t){this._scale=t}get alpha(){return Math.max(this._alpha,0)}set alpha(t){this._alpha=t}destroy(){}render(){this.active&&(nt.save(),nt.fillStyle=this.color,nt.font=`${this.scale}px Hammersmith One`,nt.strokeStyle=s.A.animatedText.outlineColor,nt.textBaseline="middle",nt.textAlign="center",nt.lineWidth=s.A.animatedText.outlineWidth,nt.lineJoin="round",nt.globalAlpha=this.alpha,nt.translate(this.x-bt.xOffset,this.y-bt.yOffset),nt.strokeText(this.text,0,0),nt.fillText(this.text,0,0),nt.restore())}update(){if(this.lifeTime<=0)return this.active=!1,this.destroy();this.lifeTime-=Mt.delta,this.alpha=this.lifeTime/this.staticLifeTime,this.velocity.sub(0,this.speed*Mt.delta),this.scale+=this.scaleSpeed*Mt.delta,this.scale>=this.maxScale?(this.scale=this.maxScale,this.scaleSpeed*=-1):this.scale<=this.staticScale&&(this.scale=this.staticScale,this.scaleSpeed=0),this.updatePhysics(),this.render()}}var V=J;var Q=class{constructor(){this.id=s.A.layers.textManager[1],this.layer=s.A.layers.textManager[0],this.texts=new Map}get list(){return[...this.texts.values()]}add(t,e,i,s,n){const a=parseInt(Math.random()*(Date.now()/1e3)-1e3*Math.random());return(e=new{animated:V}[t](a,e,i,s,n)).destroy=()=>{this.remove(a)},this.texts.set(a,e),this.texts.get(a)}remove(t){this.texts.delete(t)}update(){this.texts.forEach((t=>{t.active&&t.update()}))}init(){Mt.add(this.layer,{id:this.id,_function:this.update.bind(this)})}};var tt=function(t){const{innerWidth:e,innerHeight:i}=window,n=t.viewport.zoom||s.A.viewport.zoom,a=s.A.viewport.resolution[0]*n,r=s.A.viewport.resolution[1]*n,o=Math.max(e/a,i/r);t.viewport={resolution:[a,r],width:e/o,height:i/o,scale:o,zoom:n},t.width=e,t.height=i,t.style.width=`${e}px`,t.style.height=`${i}px`,t.context.scale(t.viewport.scale,t.viewport.scale)};CanvasRenderingContext2D.prototype.roundRect=function(t,e,i,s,n){return i<2*n&&(n=i/2),s<2*n&&(n=s/2),n<0&&(n=0),this.beginPath(),this.moveTo(t+n,e),this.arcTo(t+i,e,t+i,e+s,n),this.arcTo(t+i,e+s,t,e+s,n),this.arcTo(t,e+s,t,e,n),this.arcTo(t,e,t+i,e,n),this.closePath(),this};var et=function(t){return t.context=t.getContext("2d"),t.viewport=s.A.viewport,t.resize=()=>tt(t),window.addEventListener("resize",t.resize),t.resize(),t};const it=document.getElementById("game_canvas"),st=et(it),nt=st.context,at=new d.A("#main_menu"),rt=new d.A("#menu_card_holder"),ot=new d.A("#game_ui"),ht=new d.A("#game_state_text"),lt=new d.A("#name_input"),ct=new d.A("#enter_game"),_t=new d.A("#skin_list"),dt=new d.A("#action_bar"),ut=new d.A("#upgrades_bar"),ft=new d.A("#chat_holder"),pt=new d.A("#chat_input"),mt=new d.A("#leader_board"),yt=new d.A("#debug_panel_holder"),gt=new d.A("#toggle_clan_menu"),Et=new d.A("#clan_menu_holder"),wt=new d.A("#toggle_store_menu"),At=new d.A("#store_menu_holder"),vt=new Map;vt.hideAll=function(){this.forEach((t=>{t.hide(),this.delete(t.element.id)}))};const Mt=new P,bt=new l,xt=new n,It=new p,Ot=new a,Pt=new Y.A,Dt=new f,kt=new F,Ct=new G,Tt=new W,Lt=new Q,Bt=new X.A,Ut=new w,St=new u,Rt=new O,Wt=new c.A,jt=new D.A,$t=new g,Kt=new A,qt=new _,Ht=new M,Nt={members:[],isMemeber:function(t){return this.members.includes(t)||t===Pt.player.id}},Ft=new Map([["weapons",{}],["icons",{}],["hats",{}],["animals",{}]]),zt=new Map,Zt=new Map,Gt={camera:bt,background:xt,grid:It,particlesManager:Ct,playersManager:Pt,animalsManager:Tt,objectsManager:kt,boundings:Ot,entitiesInfo:Dt,textManager:Lt,dayNight:qt,minimap:Kt,notifications:Ht}},2559:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var msgpack_lite__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7830),_eventsList_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7848);let encodeInt=-912,getEncodeIntIndex=67.25;const fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),setupGameEvent=1..toString().repeat(fourInt-1),disconnectEvent=(getEncodeIntIndex+13)*fourInt,pingResponseEvent=(getEncodeIntIndex+5)*fourInt,pingEvent=134.5;function parseType(t){return t.toString()}class Socket{constructor(){this.uid=null,this.socket=null,this.lastPacket=null,this.lastSent=null,this.lastPingSent=null,this.ping=0}get isReady(){return 1===this.socket?.readyState}on(t,e){this.socket&&this.socket.addEventListener(t,e)}send(t){if(!this.isReady)return;t=parseType(t);const e=Array.prototype.slice.call(arguments,1);let i=(0,msgpack_lite__WEBPACK_IMPORTED_MODULE_0__.encode)([t,e]);for(let e=0;e<t.length+2;e++)i[e]+=9131*encodeInt;this.socket.send(i)}onMessage(t){const e=new Uint8Array(t.data),i=(0,msgpack_lite__WEBPACK_IMPORTED_MODULE_0__.decode)(e);i[0]===setupGameEvent&&(this.uid=i[1][0],encodeInt=i[1][getEncodeIntIndex*fourInt]),+i[0]===pingResponseEvent?this.ping=parseInt(Date.now()-this.lastPingSent):_eventsList_js__WEBPACK_IMPORTED_MODULE_1__.A[parseInt(i[0])/fourInt](i[1]),(!this.lastPingSent||Date.now()-this.lastPingSent>=2e3)&&(this.send(pingEvent*fourInt),this.lastPingSent=Date.now()),this.lastPacket=i,this.lastSent=Date.now()}onClose(){this.lastPacket&&parseInt(this.lastPacket[0])/fourInt!=disconnectEvent/fourInt&&_eventsList_js__WEBPACK_IMPORTED_MODULE_1__.A[disconnectEvent/fourInt]()}connect(t){this.socket=new WebSocket(t),this.socket.binaryType="arraybuffer",this.on("message",this.onMessage.bind(this)),this.on("close",this.onClose.bind(this))}}__webpack_exports__.A=Socket},2618:function(t,e){"use strict";e.A=function(t,e,i,s){const n=Math.PI/e,a=i;let r=Math.PI/2*3;t.beginPath(),t.moveTo(0,-s);for(let i=0;i<e;i++)t.quadraticCurveTo(Math.cos(r+n)*a,Math.sin(r+n)*a,Math.cos(r+2*n)*s,Math.sin(r+2*n)*s),r+=2*n;t.lineTo(0,-s),t.closePath()}},2705:function(t,e,i){"use strict";i.d(e,{A:function(){return h}});var s=i(2454),n=i(2618),a=i(6021),r=i(8045);var o=function(t,e){const i=t*(Math.sqrt(3)/2);e.beginPath(),e.moveTo(0,-i/2),e.lineTo(-t/2,i/2),e.lineTo(t/2,i/2),e.lineTo(0,-i/2),e.closePath()};var h=function(t,e,i){const h=`${t.name}${e?"_icon":""}`;if(!s.C9.has(h)||e){const l=document.createElement("canvas"),c=t.scale*(t.spriteScaleMult||2.5);l.width=l.height=c+t.outlineWidth+(t.spritePadding||0);const _=l.getContext("2d");if(_.translate(l.width/2,l.height/2),_.rotate(Math.PI/2),_.strokeStyle=t.outlineColor,_.lineWidth=i||t.outlineWidth,/(berry|blueberry)/.test(t.name))_.fillStyle=t.colors[0],(0,a.A)(0,0,t.scale,_),_.fill(),_.stroke();else if(/wall/.test(t.name))_.fillStyle=t.colors[0],(0,n.A)(_,t.sides,t.scale,.7*t.scale),_.fill(),_.stroke(),_.fillStyle=t.colors[1],(0,n.A)(_,t.sides,t.scale/2,t.scale/2*.7),_.fill();else if(/spike/.test(t.name)){const e=.89*t.scale;_.lineCap="round",_.lineJoin="round",_.fillStyle=t.colors[0],(0,r.A)(_,t.spikes,1.2*e,.6*e),_.fill(),_.stroke(),_.fillStyle=t.colors[1],(0,n.A)(_,t.sides,e,.7*e),_.fill(),_.stroke(),_.fillStyle=t.colors[2],(0,n.A)(_,t.sides,e/2,e/2*.7),_.fill()}else if(/windmill/.test(t.name)){if(_.fillStyle=t.colors[0],(0,n.A)(_,t.sides,1.1*t.scale,.8*t.scale),_.fill(),_.stroke(),_.fillStyle=t.colors[1],(0,n.A)(_,t.sides,t.scale/1.55*1.1,t.scale/1.55*.8),_.fill(),e){for(let e=0;e<t.blades;e++){const i=1.5*t.scale,s=t.scale/2.25;_.fillStyle=t.colors[3],_.rotate(Math.PI/2*e),_.roundRect(-i,-s/2,2*i,s,8),_.fill(),_.stroke()}_.fillStyle=t.colors[2],(0,n.A)(_,t.sides-1,t.scale/2*1.1,t.scale/2*.8),_.fill(),_.stroke()}}else if(/trap/.test(t.name))_.globalAlpha=t.alpha,_.fillStyle=t.colors[0],(0,n.A)(_,t.sides,t.scale,.75*t.scale),_.fill(),_.stroke(),_.fillStyle=t.colors[1],(0,n.A)(_,t.sides,t.scale/1.55,t.scale/1.55*.75),_.fill();else if(/boost/.test(t.name)){const e=1.6*t.scale;_.fillStyle=t.colors[0],_.lineCap="round",_.lineJoin="round",_.roundRect(-e/2,-e/2,e,e,t.radius),_.fill(),_.stroke(),_.fillStyle=t.colors[1],o(t.scale,_),_.fill()}s.C9.set(h,l)}return s.C9.get(h)}},2847:function(t,e,i){var s=i(8204),n=s.global,a=t.exports=s.hasBuffer?r(0):[];function r(t){return new n(t)}a.alloc=s.hasBuffer&&n.alloc||r,a.concat=s.concat,a.from=function(t){if(!s.isBuffer(t)&&s.isView(t))t=s.Uint8Array.from(t);else if(s.isArrayBuffer(t))t=new Uint8Array(t);else{if("string"==typeof t)return s.from.call(a,t);if("number"==typeof t)throw new TypeError('"value" argument must not be a number')}return n.from&&1!==n.from.length?n.from(t):new n(t)}},2971:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _constants_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2454);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),hitEvent=67;function onMouseUp(t){_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player?.isAlive&&_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.attackState&&!_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.autoAttackState&&(_constants_js__WEBPACK_IMPORTED_MODULE_0__.sZ.send(hitEvent*fourInt,0),_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.attackState=!1)}__webpack_exports__.A=onMouseUp},3002:function(t,e,i){"use strict";i.d(e,{A:function(){return n}});var s=[{id:0,name:"foods",place:!1},{id:1,name:"walls",place:!0,limit:40},{id:2,name:"spikes",place:!0,limit:25},{id:3,name:"mills",place:!0,limit:100},{id:4,name:"traps",place:!0,limit:15},{id:5,name:"boosts",place:!0,limit:20}],n=[{id:0,group:s[0],name:"berry",desc:"Heals you for 20 health units for 1 use\nGet red berries to usethis food",req:["food",20],heal:20,scale:14,holdOffset:10,layer:"items",outlineWidth:7,outlineColor:"#474747",colors:["#c15555","#89a54c"]},{id:1,age:2,group:s[0],name:"blueberry",desc:"Heals you for 35 health units for 1 use\nGet blue berries to use this food",req:["food",35],heal:35,scale:14,holdOffset:10,layer:"items",outlineWidth:7,outlineColor:"#474747",colors:["#5869a7","#89a54c"]},{id:2,group:s[1],name:"wall tier 1",desc:"Provides protection for your farm",req:["wood",20],health:350,scale:55,sides:4,holdOffset:27,layer:"items",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#af9241","#ba9c4a"]},{id:3,group:s[1],name:"wall tier 2",desc:"Provides improved protection for your farm",req:["wood",25],health:500,scale:55,sides:5,holdOffset:27,layer:"items",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#af9241","#ba9c4a"]},{id:4,age:2,group:s[1],name:"wall tier 3",desc:"Provides improved protection for your farm",req:["stone",25],health:700,scale:57,sides:5,holdOffset:27,layer:"items",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#828282","#949494"]},{id:5,group:s[2],name:"spike tier 1",desc:"Damages enemies when they touch them",req:["wood",20,"stone",5],health:300,damage:15,scale:49,spikes:4,sides:4,spritePadding:-23,spriteScaleMult:2.6,holdOffset:12,layer:"items",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#939393","#af9241","#ba9c4a"]},{id:6,group:s[2],name:"spike tier 2",desc:"Damages enemies when they touch them",req:["wood",25,"stone",7],health:450,damage:25,scale:49,spikes:6,sides:6,spritePadding:-23,spriteScaleMult:2.6,holdOffset:12,layer:"items",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#939393","#af9241","#ba9c4a"]},{id:7,age:4,group:s[2],name:"spike tier 3",desc:"Damages enemies when they touch them",req:["wood",15,"stone",30],health:550,damage:35,scale:52,spikes:6,sides:6,spritePadding:-23,spriteScaleMult:2.6,holdOffset:12,layer:"items",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#939393","#828282","#949494"]},{id:8,group:s[3],name:"windmill tier 1",desc:"Every second produces 1 gold",req:["wood",40,"stone",10],health:400,goldPerSecond:1,turnSpeed:.0016,scale:60,sides:6,blades:4,spritePadding:25,spriteScaleMult:2.6,iconLineMult:12,holdOffset:30,layer:"items",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#af9241","#ba9c4a","#957c37","#af9241"]},{id:9,group:s[3],name:"windmill tier 2",desc:"Every second produces 2 gold",req:["wood",30,"stone",60],health:550,goldPerSecond:2,turnSpeed:.0016,scale:60,sides:6,blades:4,spritePadding:25,spriteScaleMult:2.6,iconLineMult:12,holdOffset:30,layer:"items",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#939393","#828282","#757575","#939393"]},{id:10,group:s[4],name:"pit trap",desc:"Traps enemies when they touch them",req:["wood",25,"stone",20],health:400,scale:60,sides:5,alpha:.6,holdOffset:30,layer:"traps",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#af9241","#474747"]},{id:11,group:s[5],name:"boost pad",desc:"Provides boost when stepped on",req:["wood",15,"stone",30],health:300,scale:55,radius:8,holdOffset:25,layer:"traps",isItem:!0,outlineWidth:7,outlineColor:"#474747",colors:["#828282","#c1b72f"]}]},3043:function(t,e,i){var s,n=i(7179);e.copy=l,e.slice=c,e.toString=function(t,e,i){return(!o&&a.isBuffer(this)?this.toString:n.toString).apply(this,arguments)},e.write=(s="write",function(){return(this[s]||n[s]).apply(this,arguments)});var a=i(8204),r=a.global,o=a.hasBuffer&&"TYPED_ARRAY_SUPPORT"in r,h=o&&!r.TYPED_ARRAY_SUPPORT;function l(t,e,i,s){var r=a.isBuffer(this),o=a.isBuffer(t);if(r&&o)return this.copy(t,e,i,s);if(h||r||o||!a.isView(this)||!a.isView(t))return n.copy.call(this,t,e,i,s);var l=i||null!=s?c.call(this,i,s):this;return t.set(l,e),l.length}function c(t,e){var i=this.slice||!h&&this.subarray;if(i)return i.call(this,t,e);var s=a.alloc.call(this,e-t);return l.call(this,s,0,t,e),s}},3136:function(t,e,i){"use strict";var s=i(9576);class n{constructor(t=0,e=0){this.x=t,this.y=e}static random2D(t,e=1){return new n(e*Math.cos(t),e*Math.sin(t))}get magnitude(){return Math.sqrt(this.x**2+this.y**2)}get copy(){return new n(this.x,this.y)}setMag(t){return this.normalize().mult(t)}set(t=0,e=0){const i=(0,s.A)(t,e);return this.x=i.x,this.y=i.y,this}add(t=0,e=0){const i=(0,s.A)(t,e);return this.x+=i.x,this.y+=i.y,this}sub(t,e){const i=(0,s.A)(t,e);return this.x-=i.x,this.y-=i.y,this}mult(t,e){const i=(0,s.A)(t,e);return this.x*=i.x,this.y*=i.y,this}div(t,e){const i=(0,s.A)(t,e);return this.x/=i.x,this.y/=i.y,this}mulScalar(t){const e=(0,s.A)(t);return this.x*=e.x,this.y*=e.y,this}normalize(){const t=this.magnitude;return t<=0?this:new n(this.x,this.y).div(t||1)}projection(t){const e=t.normalize(),i=this.mulScalar(t);return e.mult(i),e}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lerp(t,e){return this.x+=(t.x-this.x)*-e,this.y+=(t.y-this.y)*-e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}distanceTo(t,e){const i=(0,s.A)(t,e);return this.copy.sub(i).length()}angleTo(t,e){const i=(0,s.A)(t,e).copy.sub(this);return Math.atan2(i.y,i.x)}random(){return this.x=Math.random(),this.y=Math.random(),this}reset(){return this.x=0,this.y=0,this}log(){console.log(this.x,this.y)}}e.A=n},3294:function(t,e,i){var s=i(816).u,n=i(5623),a=i(7970).readUint8,r=i(2004),o=i(8704);function h(){var t=this.options;return this.decode=function(t){var e=r.getReadToken(t);return function(t){var i=a(t),s=e[i];if(!s)throw new Error("Invalid type: "+(i?"0x"+i.toString(16):i));return s(t)}}(t),t&&t.preset&&n.setExtUnpackers(this),this}o.install({addExtUnpacker:function(t,e){(this.extUnpackers||(this.extUnpackers=[]))[t]=o.filter(e)},getExtUnpacker:function(t){return(this.extUnpackers||(this.extUnpackers=[]))[t]||function(e){return new s(e,t)}},init:h}),e.preset=h.call(o.preset)},3357:function(t,e,i){e.D=n;var s=i(897).preset;function n(t){if(!(this instanceof n))return new n(t);if(t&&(this.options=t,t.codec)){var e=this.codec=t.codec;e.bufferish&&(this.bufferish=e.bufferish)}}i(3614).w.mixin(n.prototype),n.prototype.codec=s,n.prototype.write=function(t){this.codec.encode(this,t)}},3398:function(t,e,i){var s=i(4634),n=i(8305),a=n.Uint64BE,r=n.Int64BE,o=i(8204),h=i(3043),l=i(1685),c=i(4040).h,_=i(816).u,d="undefined"!=typeof Uint8Array,u="undefined"!=typeof Map,f=[];f[1]=212,f[2]=213,f[4]=214,f[8]=215,f[16]=216,e.getWriteType=function(t){var e=l.getWriteToken(t),i=t&&t.useraw,n=d&&t&&t.binarraybuffer,p=n?o.isArrayBuffer:o.isBuffer,m=n?function(t,e){w(t,new Uint8Array(e))}:w,y=u&&t&&t.usemap?function(t,i){if(!(i instanceof Map))return A(t,i);var s=i.size;e[s<16?128+s:s<=65535?222:223](t,s);var n=t.codec.encode;i.forEach((function(e,i,s){n(t,i),n(t,e)}))}:A;return{boolean:function(t,i){e[i?195:194](t,i)},function:E,number:function(t,i){var s,n=0|i;if(i!==n)return void e[s=203](t,i);s=-32<=n&&n<=127?255&n:0<=n?n<=255?204:n<=65535?205:206:-128<=n?208:-32768<=n?209:210;e[s](t,n)},object:i?function(t,i){if(p(i))return function(t,i){var s=i.length;e[s<32?160+s:s<=65535?218:219](t,s),t.send(i)}(t,i);g(t,i)}:g,string:function(t){return i;function i(i,s){var n=s.length,a=5+3*n;i.offset=i.reserve(a);var r=i.buffer,o=t(n),l=i.offset+o;n=h.write.call(r,s,l);var c=t(n);if(o!==c){var _=l+c-o,d=l+n;h.copy.call(r,r,_,l,d)}e[1===c?160+n:c<=3?215+c:219](i,n),i.offset+=n}}(i?function(t){return t<32?1:t<=65535?3:5}:function(t){return t<32?1:t<=255?2:t<=65535?3:5}),symbol:E,undefined:E};function g(t,i){if(null===i)return E(t,i);if(p(i))return m(t,i);if(s(i))return function(t,i){var s=i.length;e[s<16?144+s:s<=65535?220:221](t,s);for(var n=t.codec.encode,a=0;a<s;a++)n(t,i[a])}(t,i);if(a.isUint64BE(i))return function(t,i){e[207](t,i.toArray())}(t,i);if(r.isInt64BE(i))return function(t,i){e[211](t,i.toArray())}(t,i);var n=t.codec.getExtPacker(i);if(n&&(i=n(i)),i instanceof _)return function(t,i){var s=i.buffer,n=s.length,a=f[n]||(n<255?199:n<=65535?200:201);e[a](t,n),c[i.type](t),t.send(s)}(t,i);y(t,i)}function E(t,i){e[192](t,i)}function w(t,i){var s=i.length;e[s<255?196:s<=65535?197:198](t,s),t.send(i)}function A(t,i){var s=Object.keys(i),n=s.length;e[n<16?128+n:n<=65535?222:223](t,n);var a=t.codec.encode;s.forEach((function(e){a(t,e),a(t,i[e])}))}}},3614:function(t,e,i){e.I=a,e.w=r;var s=i(8204),n="BUFFER_SHORTAGE";function a(){if(!(this instanceof a))return new a}function r(){if(!(this instanceof r))return new r}function o(){throw new Error("method not implemented: write()")}function h(){throw new Error("method not implemented: fetch()")}function l(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function c(t){(this.buffers||(this.buffers=[])).push(t)}function _(){return(this.buffers||(this.buffers=[])).shift()}function d(t){return function(e){for(var i in t)e[i]=t[i];return e}}a.mixin=d({bufferish:s,write:function(t){var e=this.offset?s.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=e?t?this.bufferish.concat([e,t]):e:t,this.offset=0},fetch:h,flush:function(){for(;this.offset<this.buffer.length;){var t,e=this.offset;try{t=this.fetch()}catch(t){if(t&&t.message!=n)throw t;this.offset=e;break}this.push(t)}},push:c,pull:_,read:l,reserve:function(t){var e=this.offset,i=e+t;if(i>this.buffer.length)throw new Error(n);return this.offset=i,e},offset:0}),a.mixin(a.prototype),r.mixin=d({bufferish:s,write:o,fetch:function(){var t=this.start;if(t<this.offset){var e=this.start=this.offset;return s.prototype.slice.call(this.buffer,t,e)}},flush:function(){for(;this.start<this.offset;){var t=this.fetch();t&&this.push(t)}},push:c,pull:function(){var t=this.buffers||(this.buffers=[]),e=t.length>1?this.bufferish.concat(t):t[0];return t.length=0,e},read:l,reserve:function(t){var e=0|t;if(this.buffer){var i=this.buffer.length,s=0|this.offset,n=s+e;if(n<i)return this.offset=n,s;this.flush(),t=Math.max(t,Math.min(2*i,this.maxBufferSize))}return t=Math.max(t,this.minBufferSize),this.buffer=this.bufferish.alloc(t),this.start=0,this.offset=e,0},send:function(t){var e=t.length;if(e>this.minBufferSize)this.flush(),this.push(t);else{var i=this.reserve(e);s.prototype.copy.call(t,this.buffer,i)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}),r.mixin(r.prototype)},3667:function(t,e){"use strict";e.A=function(t,e,i){const s=(1-i)*Math.cos(t)+i*Math.cos(e),n=(1-i)*Math.sin(t)+i*Math.sin(e);return Math.atan2(n,s)}},3752:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _constants_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2454),_game_configs_items_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3002),_game_configs_weapons_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8360);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),upgradeItemEvent=213;function onUpgradesBar_click(t){const e=t.target.querySelector(".action-bar-item-icon");if(e.classList.contains("action-weapon")){const t=parseInt(e.parentElement.parentElement.getAttribute("windex")),i=_game_configs_weapons_js__WEBPACK_IMPORTED_MODULE_2__.A[t];if(!i)return;return _constants_js__WEBPACK_IMPORTED_MODULE_0__.pH.html="",_constants_js__WEBPACK_IMPORTED_MODULE_0__.lP.hide(),_constants_js__WEBPACK_IMPORTED_MODULE_0__.sZ.send(upgradeItemEvent*fourInt,i.id,!0)}const i=parseInt(e.getAttribute("bindex")),s=_game_configs_items_js__WEBPACK_IMPORTED_MODULE_1__.A[i];s&&(_constants_js__WEBPACK_IMPORTED_MODULE_0__.pH.html="",_constants_js__WEBPACK_IMPORTED_MODULE_0__.sZ.send(upgradeItemEvent*fourInt,s.id),_constants_js__WEBPACK_IMPORTED_MODULE_0__.lP.hide())}__webpack_exports__.A=onUpgradesBar_click},3785:function(t,e,i){e.n=n;var s=i(3294).preset;function n(t){if(!(this instanceof n))return new n(t);if(t&&(this.options=t,t.codec)){var e=this.codec=t.codec;e.bufferish&&(this.bufferish=e.bufferish)}}i(3614).I.mixin(n.prototype),n.prototype.codec=s,n.prototype.fetch=function(){return this.codec.decode(this)}},3919:function(t,e,i){"use strict";i.d(e,{A:function(){return o}});var s=i(3136);var n=class{constructor(t,e,i=5,n=.9){this.mass=i,this.time=n,this.position=new s.A(t,e),this.velocity=new s.A,this.acceleration=new s.A,this.force=new s.A,this.position.lastX=this.position.x,this.position.lastY=this.position.y,this.velocity.lastX=this.velocity.x,this.velocity.lastY=this.velocity.y}updatePhysics(){this.position.lastX=this.position.x,this.position.lastY=this.position.y,this.velocity.lastX=this.velocity.x,this.velocity.lastY=this.velocity.y,this.force.div(this.mass),this.acceleration.add(this.force.x,this.force.y),this.acceleration.mult(this.time),this.velocity.add(this.acceleration.x,this.acceleration.y),this.velocity.mult(this.time),this.position.add(this.velocity.x,this.velocity.y)}resetPhysics(){this.force.reset(),this.acceleration.reset(),this.velocity.reset()}},a=i(9576);class r extends n{constructor(t,e,i,s){s=s||i,super(t,e),this.width=i,this.height=s,this.scale=(this.width+this.height)/2}get x(){return this.position.x}get y(){return this.position.y}get lastX(){return this.position.lastX}get lastY(){return this.position.lastY}set x(t){this.position.set(t,this.position.y)}set y(t){this.position.set(this.position.x,t)}get clone(){return new r(this.position.x,this.position.y,this.width,this.height)}setTo(t,e){const i=(0,a.A)(t,e);this.position.set(i)}copyFrom(t){this.setTo(t.position.x,t.position.y)}copyTo(t){t.setTo(t.position.x,t.position.y)}distanceTo(t,e){t instanceof r&&(t=new s.A(t.x,t.y));const i=(0,a.A)(this.x,this.y),n=(0,a.A)(t,e);return i.distanceTo(n)}angleTo(t,e){t instanceof r&&(t=new s.A(t.x,t.y));const i=(0,a.A)(this.x,this.y),n=(0,a.A)(t,e);return i.angleTo(n)}}var o=r},4040:function(t,e){for(var i=e.h=new Array(256),s=0;s<=255;s++)i[s]=n(s);function n(t){return function(e){var i=e.reserve(1);e.buffer[i]=t}}},4452:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5710),_constants_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2454),_utils_2d_Vector_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3136),_Player_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1635),_utils_math_lerpAngle_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3667);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),changeDirEvent=61.5,changeMoveDirEvent=91;class PlayersManager{constructor(){this.id=_config_js__WEBPACK_IMPORTED_MODULE_0__.A.layers.playersManager[1],this.layer=_config_js__WEBPACK_IMPORTED_MODULE_0__.A.layers.playersManager[0],this.players=new Map,this.player=null,this.lastUpdate=null}get list(){return[...this.players.values()]}add(t){return this.players.set(t[0],new _Player_js__WEBPACK_IMPORTED_MODULE_2__.A(t)),this.players.get(t[0])}remove(t){this.players.delete(t)}updateData(t){for(let e=0;e<t.length;e+=10){const i=this.players.get(+t[e]),s=t.slice(e,e+10);i.setData(s)}}update(){if(this.player?.isAlive){const t=window.mouseX/_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ji.viewport.scale,e=window.mouseY/_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ji.viewport.scale,i=new _utils_2d_Vector_js__WEBPACK_IMPORTED_MODULE_3__.A(this.player.x-_constants_js__WEBPACK_IMPORTED_MODULE_1__.UI.xOffset,this.player.y-_constants_js__WEBPACK_IMPORTED_MODULE_1__.UI.yOffset),s=parseFloat(i.angleTo(t,e).toFixed(3));(!this.lastUpdate||_constants_js__WEBPACK_IMPORTED_MODULE_1__.Uk.nowUpdate-this.lastUpdate>=1e3/_config_js__WEBPACK_IMPORTED_MODULE_0__.A.clientSendRate)&&(this.player.isAlive&&!this.player.lockDir&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(changeDirEvent*fourInt,s),this.lastUpdate=_constants_js__WEBPACK_IMPORTED_MODULE_1__.Uk.nowUpdate);const n=this.player.clone,a=_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has("KeyA")||_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has("ArrowLeft"),r=_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has("KeyD")||_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has("ArrowRight"),o=_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has("KeyW")||_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has("ArrowUp"),h=_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has("KeyS")||_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has("ArrowDown"),l=a&&!r?-1:!a&&r?1:0,c=o&&!h?-1:!o&&h?1:0;if(0!==l||0!==c){n.position.add(l,c),n.updatePhysics();const t=this.player.angleTo(n);t!=this.player.moveDir&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(changeMoveDirEvent*fourInt,t),this.player.moveDir=t}else null!==this.player.moveDir&&(this.player.moveDir=null,_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(changeMoveDirEvent*fourInt,this.player.moveDir));this.player.mouseDir=s}this.players.forEach((t=>{if(!t.isAlive)return;const e=_constants_js__WEBPACK_IMPORTED_MODULE_1__.Uk.nowUpdate-1e3/_config_js__WEBPACK_IMPORTED_MODULE_0__.A.serverUpdateRate,i=(t.t2-t.t1)/(e-t.t1);t.dt+=_constants_js__WEBPACK_IMPORTED_MODULE_1__.Uk.delta;const s=Math.min(1.7,t.dt/170);let n=t.x2-t.x1;t.x=t.x1+n*s,n=t.y2-t.y1,t.y=t.y1+n*s,t.dir=(0,_utils_math_lerpAngle_js__WEBPACK_IMPORTED_MODULE_4__.A)(t.dir2,t.dir1,Math.min(1.2,i)),t.update()}))}init(){_constants_js__WEBPACK_IMPORTED_MODULE_1__.Uk.add(this.layer,{id:this.id,_function:this.update.bind(this)})}}__webpack_exports__.A=PlayersManager},4457:function(t,e,i){"use strict";i.d(e,{A:function(){return d}});var s=i(4643),n=i(2454),a=i(3919),r=i(3136);class o extends a.A{constructor(t,e){super(t,e,0),this.velocity=r.A.random2D(Math.random()*Math.PI*2).setMag((0,s.A)(2,6)),this._scale=16,this.staticScale=this._scale,this._lifeTime=1e3,this.staticLifeTime=this._lifeTime}get lifeTime(){return Math.max(Math.min(this._lifeTime,this.staticLifeTime),0)}set lifeTime(t){this._lifeTime=t}get scale(){return Math.max(Math.min(this._scale,this.staticScale),0)}set scale(t){this._scale=t}destroy(){}render(){n._O.save(),n._O.fillStyle="#b9522d",n._O.strokeStyle="#bb3b2a",n._O.lineWidth=4,n._O.translate(this.x-n.UI.xOffset,this.y-n.UI.yOffset),n._O.beginPath(),n._O.arc(0,0,this.scale,0,2*Math.PI),n._O.fill(),n._O.stroke(),n._O.closePath(),n._O.restore()}update(){if(this.lifeTime<=0)return this.destroy();this.lifeTime-=n.Uk.delta,this.scale-=.014*n.Uk.delta,this.updatePhysics(),this.render()}}var h=class{constructor(t){this.target=t,this.effectID=11,this.particles=new Map,this.lastSpawnParticle=null}destroy(){}spawnParticle(){const t=parseInt(Math.random()*(Date.now()/1e3)-1e3*Math.random()),e=new o(this.target.x,this.target.y);e.destroy=()=>{this.particles.delete(t)},this.particles.set(t,e)}update(){if(!this.lastSpawnParticle||Date.now()-this.lastSpawnParticle>=425){const t=(0,s.A)(1,2);for(let e=0;e<t;e++)this.spawnParticle();this.lastSpawnParticle=Date.now()}}},l=i(8045);class c extends a.A{constructor(t,e){super(t,e,0),this.velocity=r.A.random2D(Math.random()*Math.PI*2).setMag((0,s.A)(2,6)),this._scale=16,this.staticScale=this._scale,this._lifeTime=1e3,this.staticLifeTime=this._lifeTime}get lifeTime(){return Math.max(Math.min(this._lifeTime,this.staticLifeTime),0)}set lifeTime(t){this._lifeTime=t}get scale(){return Math.max(Math.min(this._scale,this.staticScale),0)}set scale(t){this._scale=t}destroy(){}render(){n._O.save(),n._O.fillStyle="#ade4eb",n._O.strokeStyle="#2fb0c1",n._O.lineWidth=2,n._O.translate(this.x-n.UI.xOffset,this.y-n.UI.yOffset),(0,l.A)(n._O,4,1.2*this.scale,.6*this.scale),n._O.fill(),n._O.stroke(),n._O.restore()}update(){if(this.lifeTime<=0)return this.destroy();this.lifeTime-=n.Uk.delta,this.scale-=.014*n.Uk.delta,this.updatePhysics(),this.render()}}var _=class{constructor(t){this.target=t,this.effectID=11,this.particles=new Map,this.lastSpawnParticle=null}destroy(){}spawnParticle(){const t=parseInt(Math.random()*(Date.now()/1e3)-1e3*Math.random()),e=new c(this.target.x,this.target.y);e.destroy=()=>{this.particles.delete(t)},this.particles.set(t,e)}update(){(!this.lastSpawnParticle||Date.now()-this.lastSpawnParticle>=800)&&(this.spawnParticle(),this.lastSpawnParticle=Date.now())}};var d=class{constructor(t){this.target=t,this.effects=new Map}get list(){return[...this.effects.values()]}add(t){if(this.effects.has(+t))return this.effects.get(t);const e=new{11:h,12:_}[+t](this.target);return e.destroy=()=>{this.remove(t)},this.effects.set(t,e),this.effects.get(t)}remove(t){this.effects.delete(t)}update(){this.effects.forEach((t=>{t.update()})),this.effects.forEach((t=>{t.particles.forEach((t=>{t.update()}))}))}}},4634:function(t){var e={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==e.call(t)}},4643:function(t,e){"use strict";e.A=function(t,e){return Math.floor(Math.random()*(e-t+1))+t}},4726:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5710),_constants_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2454),_utils_formatText_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8666);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),spawnEvent=33;function onEnterGame_click(){_constants_js__WEBPACK_IMPORTED_MODULE_1__.Co.hide(),_constants_js__WEBPACK_IMPORTED_MODULE_1__.fP.show(),_constants_js__WEBPACK_IMPORTED_MODULE_1__.fP.text="Loading...";const t=document.querySelector(".skin-item.active-skin"),e=parseInt(t.getAttribute("index"));_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(spawnEvent*fourInt,(0,_utils_formatText_js__WEBPACK_IMPORTED_MODULE_2__.A)(_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ww.value,_config_js__WEBPACK_IMPORTED_MODULE_0__.A.maxNicknameLength,"Stabber"),e)}__webpack_exports__.A=onEnterGame_click},5160:function(t,e,i){"use strict";var s=i(2454);e.A=function(t){const e=s.Uq.get("weapons");let i=e[t.src];return i||(e[t.src]={},i=e[t.src],i.image=new Image,i.image.onload=()=>{i.isLoaded=!0},i.image.src=`./assets/weapons/${t.src}.png`),i}},5188:function(t,e,i){var s=i(8204),n=t.exports=s.hasArrayBuffer?a(0):[];function a(t){return new Uint8Array(t)}n.alloc=a,n.concat=s.concat,n.from=function(t){if(s.isView(t)){var e=t.byteOffset,i=t.byteLength;(t=t.buffer).byteLength!==i&&(t.slice?t=t.slice(e,e+i):(t=new Uint8Array(t)).byteLength!==i&&(t=Array.prototype.slice.call(t,e,e+i)))}else{if("string"==typeof t)return s.from.call(n,t);if("number"==typeof t)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(t)}},5623:function(t,e,i){e.setExtUnpackers=function(t){t.addExtUnpacker(14,[o,l(Error)]),t.addExtUnpacker(1,[o,l(EvalError)]),t.addExtUnpacker(2,[o,l(RangeError)]),t.addExtUnpacker(3,[o,l(ReferenceError)]),t.addExtUnpacker(4,[o,l(SyntaxError)]),t.addExtUnpacker(5,[o,l(TypeError)]),t.addExtUnpacker(6,[o,l(URIError)]),t.addExtUnpacker(10,[o,h]),t.addExtUnpacker(11,[o,c(Boolean)]),t.addExtUnpacker(12,[o,c(String)]),t.addExtUnpacker(13,[o,c(Date)]),t.addExtUnpacker(15,[o,c(Number)]),"undefined"!=typeof Uint8Array&&(t.addExtUnpacker(17,c(Int8Array)),t.addExtUnpacker(18,c(Uint8Array)),t.addExtUnpacker(19,[_,c(Int16Array)]),t.addExtUnpacker(20,[_,c(Uint16Array)]),t.addExtUnpacker(21,[_,c(Int32Array)]),t.addExtUnpacker(22,[_,c(Uint32Array)]),t.addExtUnpacker(23,[_,c(Float32Array)]),"undefined"!=typeof Float64Array&&t.addExtUnpacker(24,[_,c(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&t.addExtUnpacker(25,c(Uint8ClampedArray)),t.addExtUnpacker(26,_),t.addExtUnpacker(29,[_,c(DataView)]));n.hasBuffer&&t.addExtUnpacker(27,c(a))};var s,n=i(8204),a=n.global,r={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function o(t){return s||(s=i(7402).decode),s(t)}function h(t){return RegExp.apply(null,t)}function l(t){return function(e){var i=new t;for(var s in r)i[s]=e[s];return i}}function c(t){return function(e){return new t(e)}}function _(t){return new Uint8Array(t).buffer}},5710:function(t,e){"use strict";e.A={textFont:"Hammersmith One",map:{width:1e4,height:1e4,color:"#7bc059"},minimap:{width:150,height:150,pointScale:3,pointColors:{0:"#ffffff",1:"#eacd10",2:"#ba0d0d"}},maxNicknameLength:15,maxChatLength:40,maxClanNameLength:8,clientSendRate:9,serverUpdateRate:10,hitReturnRatio:.25,hitAngle:Math.PI/2,outlineWidth:7,gatherWiggle:10,chatRemoveTime:3500,gatherPacrticlesSpeed:.048,player:{scale:35,handScale:14,maxHealth:100,colors:["#bf8f54","#cbb091","#ececec","#c37373","#4c4c4c","#ecaff7","#738cc3","#8bc373","#91b2db","#be5454","#b700fa","#3c66c9","#f7cf45","#cc862b","#556877","#658f3d"],outlineColor:"#474747",outlineWidth:5.5,nickname:{size:30,xOffset:0,yOffset:-34,outlineWidth:8,color:"#fff",outlineColor:"#474747"},clan:{size:30,xOffset:0,yOffset:-68,outlineWidth:8,color:"#fff",outlineColor:"#474747",leaderIconScale:35,leaderIconXOffset:-5,leaderIconYOffset:3},healthbar:{width:40,height:16,padding:4,xOffset:0,yOffset:34,allyColor:["#7bc059","#87da5d"],enemyColor:["#c05959","#d25656"],outlineColor:"#3d3f42",radius:6},chat:{alphaTime:400,maxMessages:5,textSize:26,width:17,height:36,margin:5,xOffset:0,yOffset:-70,color:"#fff",bgColor:"rgba(0, 0, 0, .2)"}},buildings:{healthbar:{width:25,height:16,padding:4,xOffset:0,yOffset:10,allyColor:["#7bc059","#87da5d"],enemyColor:["#c05959","#d25656"],outlineColor:"#3d3f42",radius:6,hideDelay:1e3}},animals:{healthbar:{width:54,height:22,padding:4,xOffset:0,yOffset:100,color:["#c05959","#d25656"],outlineColor:"#3d3f42",radius:8}},grid:{difX:18,difY:18,width:4,color:"#3d6827",alpha:.06},boundings:{color:"#3d6827",alpha:.09},animatedText:{outlineWidth:8,colors:["#ffffff","#7bc059","#c05959","#59a6c0"],outlineColor:"#474747"},protocol:{http:location.protocol.split(":")[0],get ws(){return`ws${this.http.slice(4)}`}},host:location.host,viewport:{resolution:[1920,1080],width:window.innerWidth,height:window.innerHeight,scale:1,zoom:1},layers:{camera:[1,1],background:[1,2],grid:[1,3],particlesManager:[1,4],objectsManagerBP:[1,5],playersManager:[2,1],animalsManager:[2,2],objectsManager:[3,2],boundings:[4,1],entitiesInfo:[4,2],textManager:[4,3],dayNight:[4,4],minimap:[4,5],notifications:[4,6]}}},5938:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5710),_constants_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2454),_utils_formatText_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8666),_utils_isFocusOnInput_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1189);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),hitEvent=67,selectItemEvent=28.75,chatMessageEvent=140.75,autoAttackEvent=89;function onKeyDown(t){if("Tab"===t.code&&t.preventDefault(),"Enter"===t.code&&!_constants_js__WEBPACK_IMPORTED_MODULE_1__.Nj.isHidden&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.al.isHidden&&!_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has(t.code)){if(_constants_js__WEBPACK_IMPORTED_MODULE_1__.xD.toggle(),_constants_js__WEBPACK_IMPORTED_MODULE_1__.xD.isHidden){_constants_js__WEBPACK_IMPORTED_MODULE_1__.Hf.delete(_constants_js__WEBPACK_IMPORTED_MODULE_1__.xD.element.id);const t=(0,_utils_formatText_js__WEBPACK_IMPORTED_MODULE_2__.A)(_constants_js__WEBPACK_IMPORTED_MODULE_1__.Zj.value,_config_js__WEBPACK_IMPORTED_MODULE_0__.A.maxChatLength,"");t&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(chatMessageEvent*fourInt,t)}else _constants_js__WEBPACK_IMPORTED_MODULE_1__.Hf.hideAll(),_constants_js__WEBPACK_IMPORTED_MODULE_1__.Hf.set(_constants_js__WEBPACK_IMPORTED_MODULE_1__.xD.element.id,_constants_js__WEBPACK_IMPORTED_MODULE_1__.xD),_constants_js__WEBPACK_IMPORTED_MODULE_1__.Zj.focus();_constants_js__WEBPACK_IMPORTED_MODULE_1__.Zj.value=""}if("Escape"!==t.code||_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has(t.code)||_constants_js__WEBPACK_IMPORTED_MODULE_1__.Hf.hideAll(),!_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player?.isAlive||(0,_utils_isFocusOnInput_js__WEBPACK_IMPORTED_MODULE_3__.A)())return;const e=t.which||t.keyCode||0,i=_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.weapons,s=_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.items;if(void 0!==i[e-49]?_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(selectItemEvent*fourInt,i[e-49],!0):void 0!==s[e-49-i.length]&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(selectItemEvent*fourInt,s[e-49-i.length]),"Space"===t.code&&(!_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.attackState&&!_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.autoAttackState||_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.buildIndex>=0)&&(_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(hitEvent*fourInt,1),_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.attackState=!0),!_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has(t.code)){if("KeyQ"===t.code){if(_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.buildIndex===s[0])return;_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(selectItemEvent*fourInt,s[0])}"KeyE"===t.code&&(_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(autoAttackEvent*fourInt),_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.autoAttackState=!_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.autoAttackState),"KeyX"===t.code&&(_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.lockDir=!_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.lockDir),t.ctrlKey&&"KeyZ"===t.code&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.e1.toggle()}"Tab"===t.code&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.al.isHidden&&!_constants_js__WEBPACK_IMPORTED_MODULE_1__.HP.has(t.code)&&(_constants_js__WEBPACK_IMPORTED_MODULE_1__.Hf.forEach((t=>{t.hide()})),_constants_js__WEBPACK_IMPORTED_MODULE_1__.al.show())}__webpack_exports__.A=onKeyDown},6021:function(t,e){"use strict";e.A=function(t,e,i,s){s.beginPath(),s.arc(t,e,i,0,2*Math.PI),s.closePath()}},6355:function(t,e,i){"use strict";var s=i(2454);e.A=function(t){const e=s.Uq.get("hats");let i=e[t];return i||(e[t]={},i=e[t],i.image=new Image,i.image.onload=()=>{i.isLoaded=!0},i.image.src=`./assets/hats/${t}_hat.png`),i}},6914:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _constants_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2454),_utils_isFocusOnInput_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1189);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),hitEvent=67;function onMouseDown(t){_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player?.isAlive&&!(0,_utils_isFocusOnInput_js__WEBPACK_IMPORTED_MODULE_1__.A)()&&(!_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.attackState&&!_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.autoAttackState||_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.buildIndex>=0)&&(_constants_js__WEBPACK_IMPORTED_MODULE_0__.sZ.send(hitEvent*fourInt,1),_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.attackState=!0)}__webpack_exports__.A=onMouseDown},7131:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _constants_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2454);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),hitEvent=67;function onKeyUp(t){"Tab"===t.code&&t.preventDefault(),_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player?.isAlive&&("Space"===t.code&&_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.attackState&&!_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.autoAttackState&&(_constants_js__WEBPACK_IMPORTED_MODULE_0__.sZ.send(hitEvent*fourInt,0),_constants_js__WEBPACK_IMPORTED_MODULE_0__.wB.player.attackState=!1),"Tab"!==t.code||_constants_js__WEBPACK_IMPORTED_MODULE_0__.al.isHidden||(_constants_js__WEBPACK_IMPORTED_MODULE_0__.Hf.forEach((t=>{t.show()})),_constants_js__WEBPACK_IMPORTED_MODULE_0__.al.hide()))}__webpack_exports__.A=onKeyUp},7158:function(t,e,i){var s=i(1611),n=i(3357).D;function a(t){if(!(this instanceof a))return new a(t);n.call(this,t)}a.prototype=new n,s.mixin(a.prototype),a.prototype.encode=function(t){this.write(t),this.emit("data",this.read())},a.prototype.end=function(t){arguments.length&&this.encode(t),this.flush(),this.emit("end")}},7179:function(t,e){e.copy=function(t,e,i,s){var n;i||(i=0);s||0===s||(s=this.length);e||(e=0);var a=s-i;if(t===this&&i<e&&e<s)for(n=a-1;n>=0;n--)t[n+e]=this[n+i];else for(n=0;n<a;n++)t[n+e]=this[n+i];return a},e.toString=function(t,e,i){var s=this,n=0|e;i||(i=s.length);var a="",r=0;for(;n<i;)(r=s[n++])<128?a+=String.fromCharCode(r):(192==(224&r)?r=(31&r)<<6|63&s[n++]:224==(240&r)?r=(15&r)<<12|(63&s[n++])<<6|63&s[n++]:240==(248&r)&&(r=(7&r)<<18|(63&s[n++])<<12|(63&s[n++])<<6|63&s[n++]),r>=65536?(r-=65536,a+=String.fromCharCode(55296+(r>>>10),56320+(1023&r))):a+=String.fromCharCode(r));return a},e.write=function(t,e){var i=this,s=e||(e|=0),n=t.length,a=0,r=0;for(;r<n;)(a=t.charCodeAt(r++))<128?i[s++]=a:a<2048?(i[s++]=192|a>>>6,i[s++]=128|63&a):a<55296||a>57343?(i[s++]=224|a>>>12,i[s++]=128|a>>>6&63,i[s++]=128|63&a):(a=65536+(a-55296<<10|t.charCodeAt(r++)-56320),i[s++]=240|a>>>18,i[s++]=128|a>>>12&63,i[s++]=128|a>>>6&63,i[s++]=128|63&a);return s-e}},7402:function(t,e,i){e.decode=function(t,e){var i=new s(e);return i.write(t),i.read()};var s=i(3785).n},7830:function(t,e,i){e.encode=i(7870).encode,e.decode=i(7402).decode,i(7158),i(8762),i(1325),i(8884)},7848:function(t,e,i){"use strict";i.d(e,{A:function(){return n}});var s=i(2454);var n={27.75:function(t){s.Co.show(),s.Nj.hide(),s.fP.hide()},80.25:function(t){s.Co.hide(),s.Nj.hide(),s.t6.show(),s.fP.show(),s.fP.text="disconnected",t?.length&&""!==t[0]&&(s.fP.element.innerHTML+=`<span>${t[0]}</span>`)},113.25:function(t){if("boolean"==typeof t[0]&&!0===t[0]){const e=s.wB.add(t.slice(1));return s.wB.player=e,e.inGame=!0,s.t6.hide(),s.Nj.show(),s.fP.hide(),s.Co.hide(),s.Kq.updateNickname(),s.Kq.updateHealthBar(),void s.Kq.updateLevelBar()}s.wB.add(t)},131.75:function(t){t[0]!==s.wB.player?.id?s.wB.remove(t[0]):s.wB.player.isAlive=!1},114.5:function(t){s.wB.updateData(t)},69:function(t){s.wB.players.has(t[0])&&s.wB.players.get(t[0]).startGatherAnimation(t[1])},157.25:function(){s.wB.player.kill(),s.t6.show(),s.Nj.hide(),s.Co.show(),s.dL.reset(),s.Hf.forEach((t=>{t.hide()})),s.Hf.clear()},209.25:function(t){const e=s.wB.players.get(t[0]);e&&(e.changeHealth(t[1]),e.id===s.wB.player.id&&s.Kq.updateHealthBar())},161:function(t){s.W2.update(t[0])},74:function(t){s.wB.player[t[0]]=parseInt(t[1]),s.Kq.updateResources()},236.25:function(t){s.o.add(t)},213.75:function(t){s.o.remove(t[0])},43.5:function(t){const e=s.o.objects.get(t[0]);e&&e.doGatherWiggle(t[1])},208.25:function(t){const e=s.wB.players.get(t[0]);e&&e.receiveChat(t[1])},168:function(t){const e=s.o.objects.get(t[0]);e&&e.updateBerries(t[1])},160.75:function(t){s.wB.player.updateLevel(...t),s.Kq.updateLevelBar()},25.75:function(t){t[1]?s.wB.player.updateWeapons(t[0]):s.wB.player.updateItems(t[0]),s.wB.player.updateActionItems()},43:function(t){s.wB.player.updateUpgradesItems(t[0])},107.75:function(t){s.wB.player.updateItemsCount(t[0])},200.75:function(t){const e=s.o.objects.get(t[0]);e&&e.changeHealth(t[1])},50.25:function(t){s.kf.members=[];for(let e=0;e<t[0].length;e+=3)s.kf.members.push(t[0][e]);s.i9.updateMembers(t[0])},54.75:function(t){s.i9.updateRequests(t[0])},44.5:function(t){s.i9.updateClans(t[0])},50.5:function(t){s.i9.onJoinedClan(t[0])},55.25:function(){s.i9.onLeaveClan()},133.5:function(t){s.Wc.update(t[0])},246:function(t){s.v9.add(t)},248:function(t){s.v9.remove(t[0])},244.5:function(t){s.v9.updateData(t)},194.25:function(t){s.DF.add(...t)},56.25:function(t){s.nn.setState(t[0])},56.5:function(t){if(t[0])return s.nn.showDayNotification();s.nn.showNightNotification()}}},7870:function(t,e,i){e.encode=function(t,e){var i=new s(e);return i.write(t),i.read()};var s=i(3357).D},7970:function(t,e,i){var s=i(251),n=i(8305),a=n.Uint64BE,r=n.Int64BE;e.getReadFormat=function(t){var e=o.hasArrayBuffer&&t&&t.binarraybuffer,i=t&&t.int64;return{map:l&&t&&t.usemap?d:_,array:u,str:f,bin:e?m:p,ext:y,uint8:g,uint16:w,uint32:v,uint64:b(8,i?O:x),int8:E,int16:A,int32:M,int64:b(8,i?P:I),float32:b(4,D),float64:b(8,k)}},e.readUint8=g;var o=i(8204),h=i(3043),l="undefined"!=typeof Map,c=!0;function _(t,e){var i,s={},n=new Array(e),a=new Array(e),r=t.codec.decode;for(i=0;i<e;i++)n[i]=r(t),a[i]=r(t);for(i=0;i<e;i++)s[n[i]]=a[i];return s}function d(t,e){var i,s=new Map,n=new Array(e),a=new Array(e),r=t.codec.decode;for(i=0;i<e;i++)n[i]=r(t),a[i]=r(t);for(i=0;i<e;i++)s.set(n[i],a[i]);return s}function u(t,e){for(var i=new Array(e),s=t.codec.decode,n=0;n<e;n++)i[n]=s(t);return i}function f(t,e){var i=t.reserve(e),s=i+e;return h.toString.call(t.buffer,"utf-8",i,s)}function p(t,e){var i=t.reserve(e),s=i+e,n=h.slice.call(t.buffer,i,s);return o.from(n)}function m(t,e){var i=t.reserve(e),s=i+e,n=h.slice.call(t.buffer,i,s);return o.Uint8Array.from(n).buffer}function y(t,e){var i=t.reserve(e+1),s=t.buffer[i++],n=i+e,a=t.codec.getExtUnpacker(s);if(!a)throw new Error("Invalid ext type: "+(s?"0x"+s.toString(16):s));return a(h.slice.call(t.buffer,i,n))}function g(t){var e=t.reserve(1);return t.buffer[e]}function E(t){var e=t.reserve(1),i=t.buffer[e];return 128&i?i-256:i}function w(t){var e=t.reserve(2),i=t.buffer;return i[e++]<<8|i[e]}function A(t){var e=t.reserve(2),i=t.buffer,s=i[e++]<<8|i[e];return 32768&s?s-65536:s}function v(t){var e=t.reserve(4),i=t.buffer;return 16777216*i[e++]+(i[e++]<<16)+(i[e++]<<8)+i[e]}function M(t){var e=t.reserve(4),i=t.buffer;return i[e++]<<24|i[e++]<<16|i[e++]<<8|i[e]}function b(t,e){return function(i){var s=i.reserve(t);return e.call(i.buffer,s,c)}}function x(t){return new a(this,t).toNumber()}function I(t){return new r(this,t).toNumber()}function O(t){return new a(this,t)}function P(t){return new r(this,t)}function D(t){return s.read(this,t,!1,23,4)}function k(t){return s.read(this,t,!1,52,8)}},8045:function(t,e){"use strict";e.A=function(t,e,i,s){const n=Math.PI/e;let a=Math.PI/2*3,r=0,o=0;t.beginPath(),t.moveTo(0,-i);for(let h=0;h<e;h++)r=Math.cos(a)*i,o=Math.sin(a)*i,t.lineTo(r,o),a+=n,r=Math.cos(a)*s,o=Math.sin(a)*s,t.lineTo(r,o),a+=n;t.lineTo(0,-i),t.closePath()}},8204:function(t,e,i){var s=e.global=i(924),n=e.hasBuffer=s&&!!s.isBuffer,a=e.hasArrayBuffer="undefined"!=typeof ArrayBuffer,r=e.isArray=i(4634);e.isArrayBuffer=a?function(t){return t instanceof ArrayBuffer||f(t)}:y;var o=e.isBuffer=n?s.isBuffer:y,h=e.isView=a?ArrayBuffer.isView||g("ArrayBuffer","buffer"):y;e.alloc=u,e.concat=function(t,i){i||(i=0,Array.prototype.forEach.call(t,(function(t){i+=t.length})));var s=this!==e&&this||t[0],n=u.call(s,i),a=0;return Array.prototype.forEach.call(t,(function(t){a+=d.copy.call(t,n,a)})),n},e.from=function(t){return"string"==typeof t?p.call(this,t):m(this).from(t)};var l=e.Array=i(8964),c=e.Buffer=i(2847),_=e.Uint8Array=i(5188),d=e.prototype=i(3043);function u(t){return m(this).alloc(t)}var f=g("ArrayBuffer");function p(t){var e=3*t.length,i=u.call(this,e),s=d.write.call(i,t);return e!==s&&(i=d.slice.call(i,0,s)),i}function m(t){return o(t)?c:h(t)?_:r(t)?l:n?c:a?_:l}function y(){return!1}function g(t,e){return t="[object "+t+"]",function(i){return null!=i&&{}.toString.call(e?i[e]:i)===t}}},8236:function(t,e,i){e.setExtPackers=function(t){t.addExtPacker(14,Error,[_,h]),t.addExtPacker(1,EvalError,[_,h]),t.addExtPacker(2,RangeError,[_,h]),t.addExtPacker(3,ReferenceError,[_,h]),t.addExtPacker(4,SyntaxError,[_,h]),t.addExtPacker(5,TypeError,[_,h]),t.addExtPacker(6,URIError,[_,h]),t.addExtPacker(10,RegExp,[c,h]),t.addExtPacker(11,Boolean,[l,h]),t.addExtPacker(12,String,[l,h]),t.addExtPacker(13,Date,[Number,h]),t.addExtPacker(15,Number,[l,h]),"undefined"!=typeof Uint8Array&&(t.addExtPacker(17,Int8Array,r),t.addExtPacker(18,Uint8Array,r),t.addExtPacker(19,Int16Array,r),t.addExtPacker(20,Uint16Array,r),t.addExtPacker(21,Int32Array,r),t.addExtPacker(22,Uint32Array,r),t.addExtPacker(23,Float32Array,r),"undefined"!=typeof Float64Array&&t.addExtPacker(24,Float64Array,r),"undefined"!=typeof Uint8ClampedArray&&t.addExtPacker(25,Uint8ClampedArray,r),t.addExtPacker(26,ArrayBuffer,r),t.addExtPacker(29,DataView,r));n.hasBuffer&&t.addExtPacker(27,a,n.from)};var s,n=i(8204),a=n.global,r=n.Uint8Array.from,o={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function h(t){return s||(s=i(7870).encode),s(t)}function l(t){return t.valueOf()}function c(t){(t=RegExp.prototype.toString.call(t).split("/")).shift();var e=[t.pop()];return e.unshift(t.join("/")),e}function _(t){var e={};for(var i in o)e[i]=t[i];return e}},8305:function(t,e){!function(t){var e,i="undefined",s=i!==typeof Buffer&&Buffer,n=i!==typeof Uint8Array&&Uint8Array,a=i!==typeof ArrayBuffer&&ArrayBuffer,r=[0,0,0,0,0,0,0,0],o=Array.isArray||function(t){return!!t&&"[object Array]"==Object.prototype.toString.call(t)},h=4294967296;function l(o,l,w){var A=l?0:4,v=l?4:0,M=l?0:3,b=l?1:2,x=l?2:1,I=l?3:0,O=l?m:g,P=l?y:E,D=T.prototype,k="is"+o,C="_"+k;return D.buffer=void 0,D.offset=0,D[C]=!0,D.toNumber=L,D.toString=function(t){var e=this.buffer,i=this.offset,s=U(e,i+A),n=U(e,i+v),a="",r=!w&&2147483648&s;r&&(s=~s,n=h-n);t=t||10;for(;;){var o=s%t*h+n;if(s=Math.floor(s/t),n=Math.floor(o/t),a=(o%t).toString(t)+a,!s&&!n)break}r&&(a="-"+a);return a},D.toJSON=L,D.toArray=c,s&&(D.toBuffer=_),n&&(D.toArrayBuffer=d),T[k]=function(t){return!(!t||!t[C])},t[o]=T,T;function T(t,s,o,l){return this instanceof T?function(t,s,o,l,c){n&&a&&(s instanceof a&&(s=new n(s)),l instanceof a&&(l=new n(l)));if(!(s||o||l||e))return void(t.buffer=p(r,0));if(!u(s,o)){c=o,l=s,o=0,s=new(e||Array)(8)}if(t.buffer=s,t.offset=o|=0,i===typeof l)return;"string"==typeof l?function(t,e,i,s){var n=0,a=i.length,r=0,o=0;"-"===i[0]&&n++;var l=n;for(;n<a;){var c=parseInt(i[n++],s);if(!(c>=0))break;o=o*s+c,r=r*s+Math.floor(o/h),o%=h}l&&(r=~r,o?o=h-o:r++);B(t,e+A,r),B(t,e+v,o)}(s,o,l,c||10):u(l,c)?f(s,o,l,c):"number"==typeof c?(B(s,o+A,l),B(s,o+v,c)):l>0?O(s,o,l):l<0?P(s,o,l):f(s,o,r,0)}(this,t,s,o,l):new T(t,s,o,l)}function L(){var t=this.buffer,e=this.offset,i=U(t,e+A),s=U(t,e+v);return w||(i|=0),i?i*h+s:s}function B(t,e,i){t[e+I]=255&i,i>>=8,t[e+x]=255&i,i>>=8,t[e+b]=255&i,i>>=8,t[e+M]=255&i}function U(t,e){return 16777216*t[e+M]+(t[e+b]<<16)+(t[e+x]<<8)+t[e+I]}}function c(t){var i=this.buffer,s=this.offset;return e=null,!1!==t&&0===s&&8===i.length&&o(i)?i:p(i,s)}function _(t){var i=this.buffer,n=this.offset;if(e=s,!1!==t&&0===n&&8===i.length&&Buffer.isBuffer(i))return i;var a=new s(8);return f(a,0,i,n),a}function d(t){var i=this.buffer,s=this.offset,r=i.buffer;if(e=n,!1!==t&&0===s&&r instanceof a&&8===r.byteLength)return r;var o=new n(8);return f(o,0,i,s),o.buffer}function u(t,e){var i=t&&t.length;return e|=0,i&&e+8<=i&&"string"!=typeof t[e]}function f(t,e,i,s){e|=0,s|=0;for(var n=0;n<8;n++)t[e++]=255&i[s++]}function p(t,e){return Array.prototype.slice.call(t,e,e+8)}function m(t,e,i){for(var s=e+8;s>e;)t[--s]=255&i,i/=256}function y(t,e,i){var s=e+8;for(i++;s>e;)t[--s]=255&-i^255,i/=256}function g(t,e,i){for(var s=e+8;e<s;)t[e++]=255&i,i/=256}function E(t,e,i){var s=e+8;for(i++;e<s;)t[e++]=255&-i^255,i/=256}l("Uint64BE",!0,!0),l("Int64BE",!0,!1),l("Uint64LE",!1,!0),l("Int64LE",!1,!1)}("string"!=typeof e.nodeName?e:this||{})},8360:function(t,e){"use strict";e.A=[{id:0,src:"wood_club",name:"club",desc:"Tool for gathering resources",damage:15,range:80,gather:1,speed:350,length:90,width:180,xOffset:-9,yOffset:-18,handXOffset:0,handYOffset:0,cssScale:.17,cssTranslate:-2.5},{id:1,src:"great_axe",name:"great axe",desc:"Increased damage and gather, but attack and movement speed is less",damage:30,spdMult:.8,range:85,gather:3,speed:600,length:175,width:175,xOffset:-8,yOffset:-19,cssScale:.195,cssTranslate:-5.5},{id:2,src:"sword",name:"sword",desc:"Increased attack power but slower gathering speed",damage:30,spdMult:.9,range:110,gather:1,speed:300,length:100,width:220,xOffset:-13,yOffset:-36,handXOffsets:[10,-5],handYOffsets:[-10,-2],plusRotate:.3,cssScale:.125,cssTranslate:.5},{id:3,src:"spear",name:"spear",desc:"Increased attack power but slower gathering speed",damage:40,spdMult:.75,range:105,gather:1,speed:525,length:110,width:200,xOffset:-8,yOffset:-20,cssScale:.108,cssTranslate:-2}]},8372:function(t,e){"use strict";class i{constructor({id:t,iconSrc:e,name:i,desc:s,effect:n,price:a}){this.id=t,this.iconSrc=e,this.name=i,this.desc=s,this.effect=n,this.price=a||0,this.type="Module",this.isModule=!0}}e.A={500:new i({id:500,iconSrc:"/assets/icons/modules/more_buildings_icon.png",name:"More buildings",desc:"Increases the placement limit for each building",effect:"more_buildings",price:15e3}),501:new i({id:501,iconSrc:"/assets/icons/modules/zoom_out_icon.png",name:"Zoom out",desc:"Increases the range of drawing and scaling of the game",effect:"zoom_out",price:2e4})}},8666:function(t,e){"use strict";e.A=function(t,e,i){return!![...Array(t).join("")].every((t=>/^[A-Za-zА-Яа-я0-9.!@?#"$%&:;() *\+,\/;\-=[\\\]\^_{|}<>]$/.test(t)))&&(t?t=(t=(t=t.slice(0,e)).trim()).replace(/\s{2}/g," "):i)}},8704:function(t,e,i){var s=i(4634);e.createCodec=o,e.install=function(t){for(var e in t)a.prototype[e]=r(a.prototype[e],t[e])},e.filter=function(t){return s(t)?function(t){return t=t.slice(),function(i){return t.reduce(e,i)};function e(t,e){return e(t)}}(t):t};var n=i(8204);function a(t){if(!(this instanceof a))return new a(t);this.options=t,this.init()}function r(t,e){return t&&e?function(){return t.apply(this,arguments),e.apply(this,arguments)}:t||e}function o(t){return new a(t)}a.prototype.init=function(){var t=this.options;return t&&t.uint8array&&(this.bufferish=n.Uint8Array),this},e.preset=o({preset:!0})},8762:function(t,e,i){var s=i(1611),n=i(3785).n;function a(t){if(!(this instanceof a))return new a(t);n.call(this,t)}a.prototype=new n,s.mixin(a.prototype),a.prototype.decode=function(t){arguments.length&&this.write(t),this.flush()},a.prototype.push=function(t){this.emit("data",t)},a.prototype.end=function(t){this.decode(t),this.emit("end")}},8884:function(t,e,i){i(3294),i(897),i(8704).preset},8964:function(t,e,i){var s=i(8204),n=t.exports=a(0);function a(t){return new Array(t)}n.alloc=a,n.concat=s.concat,n.from=function(t){if(!s.isBuffer(t)&&s.isView(t))t=s.Uint8Array.from(t);else if(s.isArrayBuffer(t))t=new Uint8Array(t);else{if("string"==typeof t)return s.from.call(n,t);if("number"==typeof t)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(t)}},9421:function(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__){"use strict";var _config_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5710),_constants_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2454),_utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9590),_utils_formatText_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8666);const getEncodeIntIndex=67.25,fourInt=Math.floor(Math.sqrt(eval(`(${getEncodeIntIndex} >> 2) / 2 * 3`))),createClanEvent=58.25,removeClanEvent=61.25,kickClanMemberEvent=58.75,clanRequestEvent=59,clanRequestResolveEvent=59.25,clanRequestRejectEvent=59.5;class ClanMenu{constructor(){this.$clansMenu=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_menu_clans"),this.$membersMenu=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_menu_members"),this.$requestsMenu=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_menu_requests"),this.$clanNameInput=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_name_input"),this.$clanCreateBtn=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_create_btn"),this.$clanDissolveBtn=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_dissolve_btn"),this.$navClansText=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_nav_clans"),this.$navClanMembers=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_nav_members"),this.$navClanRequests=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_nav_requests"),this.$clansMenuItems=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_menu_clans > .clan-join-items"),this.$membersMenuItems=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_menu_members > .clan-members-items"),this.$requestsMenuItems=new _utils_$Element_js__WEBPACK_IMPORTED_MODULE_2__.A("#clan_menu_requests > .clan-requests-items"),this.isClanLeader=!1,this.requests=new Map,this.init()}getMemberLayout(t,e,i){return`\n        <li class="clan-member-item ui-element" memberid="${t}">\n            <div class="clan-member-info">\n                <span class="clan-info-text clan-member-nickname${t===_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.id?" my-clan-info-text":""}"><img class="clan-member-leader-icon${2!==i?" hidden":""}" src="../../assets/icons/clan_leader_icon.png">${e}</span>\n            </div>\n\n            \x3c!--<div class="clan-btn clan-gift-btn game-button ui-element">Gift</div>--\x3e\n\n            <div class="clan-btn clan-kick-btn game-button ui-element${!this.isClanLeader||this.isClanLeader&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.id===t?" hidden":""}">Kick</div>\n        </li>\n        `}getRequestLayout(t,e){return`\n        <li class="clan-request-item ui-element" memberid="${t}">\n            <div class="clan-request-info">\n                <span class="clan-info-text clan-member-nickname">${e}</span>\n            </div>\n\n            <div class="clan-request-actions">\n                <div class="clan-btn clan-resolve-btn game-button ui-element">\n                    <i class="material-icons" style="font-size:28px; color: #7bc059;">&#xE876;</i>\n                </div>\n\n                <div class="clan-btn clan-reject-btn game-button ui-element">\n                    <i class='material-icons' style="font-size:28px; color: #c05959;">&#xE14C;</i>\n                </div>\n            </div>\n        </li>\n        `}getClanLayout(t,e,i,s){return`\n        <li class="clan-join-item ui-element" clanid="${t}">\n            <div class="clan-join-info">\n                <span class="clan-info-text clan-join-name">${e}</span>\n                <span class="clan-info-text clan-join-leader">Leader: ${i}</span>\n                <span class="clan-info-text clan-join-members">Members: ${s}</span>\n            </div>\n\n            <div class="clan-btn clan-join-btn game-button ui-element">Join</div>\n        </li>\n        `}onJoinedClan(t){this.isClanLeader=t,this.$clansMenu.hide(),this.$navClansText.hide(),this.$requestsMenu.hide(),this.$membersMenu.show(),this.$navClanMembers.show(),this.$navClanMembers.classes.remove("clan-btn","game-button","ui-element","active-game-btn"),this.$navClanMembers.classes.remove("clan-nav-text"),t?(this.$navClanMembers.classes.add("clan-btn","game-button","ui-element","active-game-btn"),this.$navClanRequests.show()):this.$navClanMembers.classes.add("clan-nav-text"),this.$clanDissolveBtn.text=t?"Dissolve":"Leave",_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ux.query("img").src="./assets/icons/in_clan_icon.png"}onLeaveClan(){this.isClanLeader=!1,this.$requestsMenu.hide(),this.$membersMenu.hide(),this.$navClanMembers.hide(),this.$navClanRequests.hide(),this.$clansMenu.show(),this.$navClansText.show(),_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ux.query("img").src="./assets/icons/no_clan_icon.png"}updateClans(t){t.length?this.$clansMenuItems.classes.remove("no-items"):this.$clansMenuItems.classes.add("no-items"),this.$clansMenuItems.html="";for(let e=0;e<t.length;e+=4){const i=t.slice(e,e+4),s=this.getClanLayout(...i);this.$clansMenuItems.insert(s);const n=document.querySelector(`.clan-join-item[clanid="${i[0]}"]`);this.initClanEvents(n)}}updateMembers(t){this.$membersMenuItems.html="";for(let e=0;e<t.length;e+=3){const i=t.slice(e,e+3),s=this.getMemberLayout(...i);if(this.$membersMenuItems.insert(s),this.isClanLeader){const t=document.querySelector(`.clan-member-item[memberid="${i[0]}"]`);this.initMemberEvents(t)}}}updateRequests(t){t.length?this.$requestsMenuItems.classes.remove("no-items"):(this.requests.clear(),this.$requestsMenuItems.classes.add("no-items")),this.$requestsMenuItems.html="";for(let e=0;e<t.length;e+=2){const i=t.slice(e,e+2),s=this.getRequestLayout(...i);if(this.$requestsMenuItems.insert(s),this.requests.has(i[0])||_constants_js__WEBPACK_IMPORTED_MODULE_1__.$e.add(`${i[1]} wants to join the clan`,null,"clan_request_icon"),this.requests.set(i[0],!0),this.isClanLeader){const t=document.querySelector(`.clan-request-item[memberid="${i[0]}"]`);this.initRequestEvents(t),this.requests.size>0?_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ux.setAttr("data-notifications-count",this.requests.size.toString()):_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ux.removeAttr("data-notifications-count","")}else _constants_js__WEBPACK_IMPORTED_MODULE_1__.Ux.removeAttr("data-notifications-count","")}}initClanEvents(t){t.addEventListener("click",(e=>{if(!e?.isTrusted)return;if(e.stopPropagation(),!e.target.classList.contains("clan-join-btn"))return;const i=parseInt(t.getAttribute("clanid"));i&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(clanRequestEvent*fourInt,i)}))}initMemberEvents(t){t.addEventListener("click",(e=>{if(!e?.isTrusted)return;e.stopPropagation();const i=parseInt(t.getAttribute("memberid"));i&&e.target.classList.contains("clan-kick-btn")&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(kickClanMemberEvent*fourInt,i)}))}initRequestEvents(t){t.addEventListener("click",(e=>{if(!e?.isTrusted)return;e.stopPropagation();const i=parseInt(t.getAttribute("memberid"));if(!i)return;let s=e.target;s.classList.contains("clan-btn")||(s=s.parentElement),s.classList.contains("clan-resolve-btn")?(_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(clanRequestResolveEvent*fourInt,i),this.requests.delete(+i)):s.classList.contains("clan-reject-btn")&&(_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(clanRequestRejectEvent*fourInt,i),this.requests.delete(+i)),this.isClanLeader&&(this.requests.size>0?_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ux.setAttr("data-notifications-count",this.requests.size.toString()):_constants_js__WEBPACK_IMPORTED_MODULE_1__.Ux.removeAttr("data-notifications-count"))}))}init(){this.$clanCreateBtn.on("click",(t=>{if(!t?.isTrusted)return;const e=(0,_utils_formatText_js__WEBPACK_IMPORTED_MODULE_3__.A)(this.$clanNameInput.value,_config_js__WEBPACK_IMPORTED_MODULE_0__.A.maxClanNameLength,"");e&&!_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.clan&&(_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(createClanEvent*fourInt,e),this.$clanNameInput.value="")})),this.$clanDissolveBtn.on("click",(t=>{t?.isTrusted&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.clan&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.sZ.send(removeClanEvent*fourInt)})),this.$navClanMembers.on("click",(t=>{t?.isTrusted&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.isClanLeader&&(this.$navClanRequests.classes.remove("active-game-btn"),this.$navClanMembers.classes.add("active-game-btn"),this.$requestsMenu.hide(),this.$membersMenu.show())})),this.$navClanRequests.on("click",(t=>{t?.isTrusted&&_constants_js__WEBPACK_IMPORTED_MODULE_1__.wB.player.isClanLeader&&(this.$navClanMembers.classes.remove("active-game-btn"),this.$navClanRequests.classes.add("active-game-btn"),this.$membersMenu.hide(),this.$requestsMenu.show())}))}}__webpack_exports__.A=ClanMenu},9576:function(t,e,i){"use strict";var s=i(3136);e.A=function(t,e){let i=null;return i=arguments[0]instanceof s.A?new s.A(arguments[0].x,arguments[0].y):"number"==typeof arguments[0]&&void 0===arguments[1]?new s.A(arguments[0],arguments[0]):"number"==typeof arguments[0]&&"number"==typeof arguments[1]?new s.A(t,e):new s.A(0,0),i}},9590:function(t,e){"use strict";class i{constructor(t){this.selector=t,this.element=document.querySelector(this.selector)}get text(){return this.element.innerText}set text(t){this.element.innerText=t}get html(){return this.element.innerHTML}set html(t){this.element.innerHTML=t}get value(){return this.element.value}set value(t){this.element.value=t}get src(){return this.element.src}set src(t){this.element.src=t}get classes(){return this.element.classList}get isHidden(){return this.classes.contains("hidden")}getAll(t){return[...this.element.querySelectorAll(t)]}insert(t,e=!1,i="beforeend"){if(!e)return this.element.insertAdjacentHTML(i,t);this.element.insertAdjacentText(i,t)}on(t,e){this.element.addEventListener(t,e)}toggle(){this[this.isHidden?"show":"hide"]()}show(){this.isHidden&&this.classes.remove("hidden")}hide(){this.isHidden||this.classes.add("hidden")}setStyles(...t){if(!(t.length<2))for(let e=0;e<t.length;e+=2)this.element.style[t[e]]=t[e+1]}focus(){this.element.focus()}append(t){this.element.appendChild(t)}getAttr(t){return this.element.getAttribute(t)}setAttr(t,e){this.element.setAttribute(t,e)}removeAttr(t){this.element.removeAttribute(t)}query(t){return new i(`${this.selector} > ${t}`)}}e.A=i},9879:function(t,e){"use strict";class i{constructor({id:t,iconSrc:e,src:i,name:s,type:n,desc:a,scale:r,price:o,skinRotate:h,reverseSpriteAnim:l,spriteFrameSpeed:c}){this.id=t,this.iconSrc=e,this.src=i,this.name=s,this.type=n,this.desc=a,this.scale=r||120,this.price=o||0,this.skinRotate=h,this.reverseSpriteAnim=l,this.spriteFrameSpeed=c,this.isHat=!0}}e.A={11:new i({id:11,iconSrc:"/assets/hats/boost/boost_hat_gif.gif",src:["boost/boost_1","boost/boost_2","boost/boost_3","boost/boost_4"],name:"Booster Hat",type:"Physical",desc:"Increases the speed of movement",price:4e3,spriteFrameSpeed:50}),12:new i({id:12,iconSrc:"/assets/hats/fire/fire_hat_gif.gif",src:["fire/fire_1","fire/fire_2","fire/fire_3","fire/fire_4"],name:"Fire Hat",type:"Magic",desc:"Sets the player on fire and deals permanent 4 damage to the player for 5 seconds",price:1e4,spriteFrameSpeed:75}),13:new i({id:13,iconSrc:"/assets/hats/demlood/demlood_hat_gif.gif",src:["demlood/demlood_1","demlood/demlood_2","demlood/demlood_3","demlood/demlood_4","demlood/demlood_5"],name:"Demlood Hat",type:"Mythical",desc:"Demon blood hat is so called because it increases your damage, but at the same time takes away your health",price:8e3,spriteFrameSpeed:75,scale:140}),14:new i({id:14,iconSrc:"/assets/hats/ice/ice_hat.png",src:"ice/ice",name:"Ice Hat",type:"Magic",desc:"The player will be frozen for 4 seconds. Reuse after 3 seconds",price:13e3}),1e3:new i({id:1e3,iconSrc:"/assets/hats/credits/nudo_hat.png",src:"credits/nudo",name:"Nudo Hat",type:"Credit",desc:"Main dev :3"}),1001:new i({id:1001,iconSrc:"/assets/hats/credits/forbiddy_hat.png",src:"credits/forbiddy",type:"Credit",name:"Mysthiccy Eaten",desc:"haii ^-^ hiii haiii~ <3 hiiiii :33"}),2e3:new i({id:2e3,iconSrc:"/assets/hats/free/stabmoo_hat.png",src:"free/stabmoo",type:"Free",name:"StabMoo Cap",desc:"Good cap :3"}),2001:new i({id:2001,iconSrc:"/assets/hats/free/berry_hat.png",src:"free/berry",type:"Free",name:"Berry Cap",desc:"Well, what can I say?! This is a berry cap"}),2002:new i({id:2002,iconSrc:"/assets/hats/free/diep_hat.png",src:"free/diep",type:"Free",name:"Diep Cap",desc:"Diep.io???"})}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.d=function(t,e){for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var __webpack_exports__={};!function(){"use strict";var t=__webpack_require__(5710),e=__webpack_require__(2454),i=__webpack_require__(1189),s=__webpack_require__(761),n=__webpack_require__(3002),a=__webpack_require__(8360);var r=function(t){t.stopPropagation();let i=t.target;for(;!i.classList.contains("action-bar-item");)i=i.parentElement;const s=i.querySelector(".action-bar-item-icon.action-weapon"),r=parseInt(i.getAttribute("index")),o=s?a.A[r]:n.A[r];e.lP.show(o)};var o=function(){e.lP.hide()},h=__webpack_require__(4726),l=__webpack_require__(5938),c=__webpack_require__(7131),_=__webpack_require__(6914),d=__webpack_require__(2971);var u=function(t){localStorage.setItem("oldmoo_name",t.target.value)};var f=function(t){const i=t.target.classList;if(i.contains("active-skin")||!i.contains("skin-item"))return;const s=e.go.getAll(".skin-item");for(let t=0;t<s.length;t++)s[t].classList.remove("active-skin");i.add("active-skin")};var p=function(){if(e.Ig.toggle(),!e.Ig.isHidden)return e.Hf.hideAll(),e.Hf.set(e.Ig.element.id,e.Ig);e.Hf.delete(e.Ig.element.id)};var m=function(){if(e.pW.toggle(),!e.pW.isHidden)return e.Hf.hideAll(),e.Hf.set(e.pW.element.id,e.pW);e.Hf.delete(e.pW.element.id)},y=__webpack_require__(3752);var g=function(t){t.stopPropagation();let i=t.target;for(;!i.classList.contains("action-bar-item");)i=i.parentElement;const s=i.querySelector(".action-bar-item-icon.action-weapon"),r=parseInt(i.getAttribute(s?"windex":"index")),o=s?a.A[r]:n.A[r];e.lP.show(o)};var E=function(){e.lP.hide()};function w(t){return function(e){e&&e instanceof Event&&function(t){return!t||"boolean"!=typeof t.isTrusted||t.isTrusted}(e)&&t(e)}}var A=function(){window.addEventListener("mousemove",(t=>{window.mouseX=t.clientX,window.mouseY=t.clientY}),!1),document.addEventListener("focus",(()=>{e.dL.reset()})),e.Ww.value=localStorage.getItem("oldmoo_name")||"",e.Ww.on("blur",w(u),!1),e.rH.on("click",w(h.A),!1),e.go.on("click",w(f),!1),e.er.on("click",w(s.A),!1),e.er.on("mouseover",w(r),!1),e.er.on("mouseout",w(o),!1),e.Ux.on("click",w(p),!1),e.PQ.on("click",w(m),!1),e.pH.on("click",w(y.A),!1),e.pH.on("mouseover",w(g),!1),e.pH.on("mouseout",w(E),!1),e.hr.addEventListener("mousedown",w(_.A),!1),e.hr.addEventListener("mouseup",w(d.A),!1),window.addEventListener("keydown",w(l.A),!1),window.addEventListener("keyup",w(c.A),!1),window.addEventListener("keydown",(t=>{if((0,i.A)())return e.HP.clear();e.HP.has(t.code)||e.HP.set(t.code,!0)}),!1),window.addEventListener("keyup",(t=>{if((0,i.A)())return e.HP.clear();e.HP.has(t.code)&&e.HP.delete(t.code)}),!1)};e.Uk.update();for(const t of Object.values(e.AP))t.isInit||(t.init(),t.isInit=!0);window.onload=async function(){A(),e.sZ.connect(`${t.A.protocol.ws}://${t.A.host}/ws`)},document.oncontextmenu=()=>!1,window.oncontextmenu=()=>!1,window.addEventListener("contextmenu",(t=>{t.preventDefault()}),!1)}()})();